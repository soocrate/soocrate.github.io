(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{151:function(e,t,n){e.exports={root:"Storage_root__12xUB",table:"Storage_table__3F5YM",tableWrapper:"Storage_tableWrapper__1hb1n"}},232:function(e,t,n){e.exports={document:"NewDocument_document__3aIU9"}},243:function(e){e.exports={a:"0.2.5"}},244:function(e,t,n){e.exports={logo:"App_logo__2xcQf"}},259:function(e,t,n){e.exports=n(642)},276:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=276},306:function(e,t){},308:function(e,t){},318:function(e,t){},320:function(e,t){},351:function(e,t){},425:function(e){e.exports={}},455:function(e,t,n){},49:function(e,t,n){e.exports={card:"Configuration_card__MXNHL",submit:"Configuration_submit__1rjev",button:"Configuration_button__3bv20",textField:"Configuration_textField__3OPwN",avatar:"Configuration_avatar__104bh"}},61:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var a=n(147),i=n.n(a);function o(){return"c"+i.a.generate()}i.a.characters("0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_-")},642:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),o=n(35),r=n.n(o),s=n(74),c=n(58),u=n(12),l=n(15),d=n.n(l),h=n(28),m=n(4),p=n(5),v=n(72),g=n(116),f=n(11),b=n(8),y=n(10),k=n(34),w=n(258),_=function(){function e(){Object(m.a)(this,e)}return Object(p.a)(e,[{key:"SESSION_NOT_FOUND",value:function(e){for(var t="Session ID ".concat(e," Not found in CRATE"),n=arguments.length,a=new Array(n>1?n-1:0),i=1;i<n;i++)a[i-1]=arguments[i];return this.getError.apply(this,["SESSION_NOT_FOUND",t].concat(a))}},{key:"getError",value:function(e,t){for(var n=function(e){function t(e,n){var a,i;Object(m.a)(this,t);for(var o=arguments.length,r=new Array(o>2?o-2:0),s=2;s<o;s++)r[s-2]=arguments[s];return(i=Object(f.a)(this,(a=Object(b.a)(t)).call.apply(a,[this,n].concat(r)))).name=e,i.message=n,"function"===typeof Error.captureStackTrace?Error.captureStackTrace(Object(k.a)(Object(k.a)(i)),i.constructor):i.stack=new Error(n).stack,i}return Object(y.a)(t,e),t}(Object(w.a)(Error)),a=arguments.length,i=new Array(a>2?a-2:0),o=2;o<a;o++)i[o-2]=arguments[o];return Object(g.a)(n,[e,t].concat(i))}}]),e}(),C=n(27),O=n(229),E=n.n(O),S=n(30)("CRATE:Event"),D=function(e){function t(e){var n;return Object(m.a)(this,t),(n=Object(f.a)(this,Object(b.a)(t).call(this)))._buffer=[],n._document=e.document,n._communicationChannel=n._document._communication._data_comm,n._name=e.EventName,n._document.on(n.getType(),function(e){e&&e.pairs?n.receiveBuffer(e):e?n.receiveBuffer({pairs:[e]}):console.error("Receive Event without data",n.getType())}),n._document.on("".concat(n._name,"_Action_Event"),function(e){S('on "'.concat(n._name,'_Action_Event"')),n.action(e)}),n}return Object(y.a)(t,e),Object(p.a)(t,[{key:"getEncapsulatedMessage",value:function(e){}},{key:"setLastChangesTime",value:function(){this._document.setLastChangesTime()}},{key:"getType",value:function(){if(this._name)return"".concat(this._name,"_Event");console.error("Event without name")}},{key:"getPacket",value:function(e){return Object(u.a)({event:this.getType()},e)}},{key:"broadcast",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];clearTimeout(this._timeoutBuffer),this._buffer.push(Object(u.a)({},e,{causalId:this.getCausalId()})),this._timeoutBuffer=setTimeout(function(){var e=t.getPacket({pairs:t._buffer});t.broadcastStream(Object(u.a)({},e,{stream:n})),S("broadcast message",e),t._buffer=[]},1)}},{key:"getCausalId",value:function(){return this._communicationChannel.broadcast._causality.increment()}},{key:"broadcastStream",value:function(e){var t=this._communicationChannel.streamBroadcast();this.sendStream(t,e)}},{key:"unicast",value:function(){var e=Object(h.a)(d.a.mark(function e(t,n){var a,i,o,r=arguments;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.length>2&&void 0!==r[2]&&r[2],(i=r.length>3&&void 0!==r[3]?r[3]:null)||(i=this.getCausalId()),o=this.getPacket({pairs:[Object(u.a)({},n,{causalId:i})]}),t=this.formatId(t),e.next=7,this.unicastStream(t,Object(u.a)({},o,{stream:a}));case 7:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"formatId",value:function(e){S("Id before formatiting",e);var t=this.cleanId(e);return S("Id after formatiting",t+="-I"),t}},{key:"cleanId",value:function(e){var t=e.slice(0,e.length-4),n=e.slice(e.length-4,e.length);return n=this.removeFromString("-I",n),t+(n=this.removeFromString("-O",n))}},{key:"removeFromString",value:function(e,t){var n=t.lastIndexOf(e);return n>=0&&(t=t.slice(0,n)+t.slice(n+e.length)),t}},{key:"unicastStream",value:function(){var e=Object(h.a)(d.a.mark(function e(t,n){var a;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return S("message sent on stream unicast"),a=this._communicationChannel.streamUnicast(t),e.next=4,this.sendStream(a,n);case 4:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"sendStream",value:function(e,t){var n=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;new Promise(function(i,o){var r="";try{r=JSON.stringify(t)}catch(u){console.error("Error in JSON.stringify of object",u),o("Error in JSON.stringify of object")}var s=n.chunkSubstr(r,a),c={numberOfChunks:s.length};e.write(c),s.forEach(function(t){e.write(t)}),e.end(),i()})}},{key:"sendLocalBroadcast",value:function(e){var t=this;this._communicationChannel.broadcast._source.getNeighbours().forEach(function(n){return t.unicast(n,e,!1,t.getCausalId())})}},{key:"receiveBuffer",value:function(e){var t=this,n=e.pairs,a=e.stream,i=e.originID;S("receiveBuffer",this.getType(),n.length,n),n.length>=1?n.forEach(function(e){a?t.passMsgByBroadcast(e,i):t.receive(e)}):console.warn("Receiving empty message")}},{key:"passMsgByBroadcast",value:function(e,t){var n=e.pair&&e.pair.causalId||e.causalId;S("passMsgByBroadcast:",{elem:e,originID:t,causalId:n});var a=this.getPacket({pairs:[e],stream:!1}),i=e.isReady,o=this._communicationChannel.broadcast,r=this.getBroadcastMessageFormat(o._protocol,n,i,a);!r.id||r.id.e,o._receive(n+"-O",r)}},{key:"sendBroadcast",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return S("Send Broadcast ",{msg:e,isReady:t}),this._document.lastSentMsgId=this._communicationChannel.broadcast.send(Object(u.a)({},e,{isReady:t}),null,t,!1),this._document.lastSentMsgId}},{key:"sendUnicast",value:function(e,t){this._communicationChannel.sendUnicast(e,t)}},{key:"haveBeenReceived",value:function(e){return this._communicationChannel.broadcast._shouldStopPropagation(e)}},{key:"getSize",value:function(e){return JSON.stringify(e).length}},{key:"receive",value:function(e){S("default receive",e)}},{key:"action",value:function(e){console.error("action not defined",this._name)}},{key:"sendAction",value:function(e,t){S("sendAction",t),this.Event("".concat(e,"_Action"),t)}},{key:"Event",value:function(e,t){S("Event: ","".concat(e,"_Event"),t),this._document.emit("".concat(e,"_Event"),t)}},{key:"chunkSubstr",value:function(e,t){try{for(var n=Math.ceil(e.length/t),a=new Array(n),i=0,o=0;i<n;++i,o+=t)a[i]=e.substr(o,t);return a}catch(r){throw console.error("Error in spliting the object ",r),new Error("Error in spliting the object ",r)}}},{key:"getCausalID",value:function(e){var t={e:e.t.s,c:e.t.c};return S("getCausalID",{lseqNode:e,causalId:t}),t}},{key:"getBroadcastMessageFormat",value:function(e,t,n,a){return{protocol:e,id:t,isReady:n,payload:a}}},{key:"close",value:function(){}}]),t}(C.EventEmitter),I=(n(30)("CRATE:Communication:MarkerManager:MarkerEvent"),function(e){function t(e){var n;return Object(m.a)(this,t),(n=Object(f.a)(this,Object(b.a)(t).call(this,e)))._communicationChannel=n._document._communication._behaviors_comm,n._defaultOptions={lifeTime:5e3,range:{index:0,length:0},cursor:!1},n}return Object(y.a)(t,e),Object(p.a)(t,[{key:"addMarker",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.emit("addMarker",e,t,n)}},{key:"removeMarker",value:function(){}}]),t}(D)),j=(n(30)("CRATE:Communication:MarkerManager:PingManger"),function(e){function t(e){var n;Object(m.a)(this,t);var a=e.EventName||"Ping";return(n=Object(f.a)(this,Object(b.a)(t).call(this,Object(u.a)({EventName:a},e))))._startTimer={},n._pingPeriod=e.PingPeriod,n.startPing(n._pingPeriod),n}return Object(y.a)(t,e),Object(p.a)(t,[{key:"startPing",value:function(e){var t=this;this._startTimer=setInterval(function(){t.broadcast(t._document.user)},e)}},{key:"stopPing",value:function(){clearInterval(this._startTimer)}},{key:"receive",value:function(e){var t=e.id,n=e.pseudo;this.emit("Ping_received",{id:t,pseudo:n})}},{key:"close",value:function(){this.stopPing()}}]),t}(I)),x=(n(30)("CRATE:Communication:MarkerManager:CaretManger"),function(e){function t(e){var n;Object(m.a)(this,t);var a=e.EventName||"Caret";return(n=Object(f.a)(this,Object(b.a)(t).call(this,Object(u.a)({EventName:a},e))))._defaultOptions={lifeTime:5e3,cursor:!0},n}return Object(y.a)(t,e),Object(p.a)(t,[{key:"caretMoved",value:function(e){return this.broadcast({range:e,id:this._document.uid}),e}},{key:"receive",value:function(e){var t=e.range,n=e.id;this.emit("Caret_received",{range:t,id:n})}}]),t}(I)),A=n(30)("CRATE:Communication:MarkerManager:MarkerManager"),T=function(e){function t(e){var n;Object(m.a)(this,t);var a=e.EventName||"MarkerManager";return(n=Object(f.a)(this,Object(b.a)(t).call(this,Object(u.a)({EventName:a},e))))._pingManager=new j(Object(u.a)({},e)),n._caretManger=new x(Object(u.a)({},e)),n._pingManager.on("Ping_received",function(e){n.emit("Ping_received",e)}),n._caretManger.on("Caret_received",function(e){n.emit("Caret_received",e),A("Caret_received",e)}),n}return Object(y.a)(t,e),Object(p.a)(t,[{key:"caretMoved",value:function(e){this._caretManger.caretMoved(e)}},{key:"close",value:function(){this._pingManager.close(),this._caretManger.close()}}]),t}(I),M=(n(30)("CRATE:Communication:TextManager:TextEvent"),function(e){function t(e){var n;return Object(m.a)(this,t),(n=Object(f.a)(this,Object(b.a)(t).call(this,e)))._communicationChannel=n._document._communication._data_comm,n._sequence=n._document.sequence,n}return Object(y.a)(t,e),Object(p.a)(t,[{key:"getLSEQID",value:function(e){var t=e.pair,n=e.id;return t&&(n=t.id),{e:n._s[n._s.length-1],c:n._c[n._c.length-1]}}}]),t}(D)),N=n(146),F=n.n(N),P=n(30)("CRATE:Communication:TextManager:AntiEntropyManager"),R=function(e){function t(e){var n;Object(m.a)(this,t);var a=e.EventName||"Anti-Entropy";return(n=Object(f.a)(this,Object(b.a)(t).call(this,Object(u.a)({EventName:a},e))))._antiEntropyPeriod=e.AntiEntropyPeriod,n._textManager=e.TextManager,n._communicationChannel=n._document._communication._behaviors_comm,n.on("Request",function(e){n.receiveRequest(e)}),n.on("Response",function(e){n.receiveResponse(e)}),setTimeout(function(){n.sendAntiEntropyRequest()},1e3),n}return Object(y.a)(t,e),Object(p.a)(t,[{key:"start",value:function(){P("AntiEntropyManager","start","Period",this._antiEntropyPeriod,this),this.startAntiEntropy(2e3)}},{key:"receive",value:function(e){this.emit(e.type,Object(u.a)({},e))}},{key:"receiveRequest",value:function(){var e=Object(h.a)(d.a.mark(function e(t){var n,a,i,o,r,s;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.id,a=t.causality,i=this._document._communication.causality.clone(),o=new F.a(null).constructor.fromJSON(a),P("receiveRequest",{antiEntropyPeriod:this._antiEntropyPeriod,id:n,remoteVVwE:o,localVVwE:i}),r=this.getMissingLSEQIDsForVVWE(i,o),s=this.getElements(r),P("Receive AntiEntropy And there are differences",n,o,i,s),e.next=9,this.sendAntiEntropyResponse(n,i,s);case 9:r.length>0&&(console.log("sendAction","Title",this._document.name),this.sendAction("Title",this._document.name,n)),this.getMissingLSEQIDsForVVWE(o,i).length>0&&this.sendAntiEntropyRequest(n);case 12:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getMissingLSEQIDsForVVWE",value:function(e,t){var n=this,a=[];return e.vector.arr.forEach(function(e){var i=t.vector.indexOf(e),o=null;i>0&&(o=t.vector.arr[i]);var r=n.getMissingLSEQIDsForOneEntry(e,o);Array.prototype.push.apply(a,r)}),a}},{key:"getMissingLSEQIDsForOneEntry",value:function(e,t){var n=1;t&&(n=t.v+1);for(var a=[],i=n;i<=e.v;++i)e.x.indexOf(i)<0&&a.push({_e:e.e,_c:i});if(t)for(var o=0;o<t.x.length;++o){var r=t.x[o];e.x.indexOf(r)<0&&r<=e.v&&a.push({_e:e.e,_c:r})}return a}},{key:"getElements",value:function(e){var t=this,n=this.getLSEQNodes();P("getElements",{toSearch:e,lseqNodes:n});var a=[];return n.forEach(function(n){t.isIdInSet({id:n.t.s,clock:n.t.c,toSearch:e})&&a.push(n)}),a}},{key:"getLSEQNodes",value:function(){var e=[];return function t(n){n.e&&""!=n.e&&e.push(n),n.children.forEach(function(e){t(e)})}(this._sequence.root),e}},{key:"getLSEQNodes",value:function(){var e=[];return function t(n){n.e&&""!=n.e&&e.push(n),n.children.forEach(function(e){t(e)})}(this._sequence.root),e}},{key:"isIdInSet",value:function(e){for(var t=e.id,n=e.clock,a=e.toSearch,i=0;i<a.length;i++){var o=a[i],r=o._e,s=o._c;if(r===t&&s===n)return!0}return!1}},{key:"receiveResponse",value:function(e){var t=this,n=e.elements,a=e.causalityAtReceipt;P("receiveResponse",{elements:n,causalityAtReceipt:a});var i=[];n.forEach(function(e){var n=t.getCausalID(e),a={id:n},o=e.t.s.split("-")[0],r={elem:e.e,id:e.e.id};t.haveBeenReceived(a)||i.push({pair:r,id:o,causalId:n,antientropy:!0})}),this.Event("Insert",{pairs:i,stream:!0}),this._document._communication.causality.merge(a)}},{key:"startAntiEntropy",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2e3;this._intervalAntiEntropy=setInterval(function(){e.sendAntiEntropyRequest()},t)}},{key:"sendAntiEntropyRequest",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this._document._options.editingSessionID,n={type:"Request",id:t,causality:this._document._communication.causality};e?this.unicast(e,n,!1,this.getCausalId()):this.sendLocalBroadcast(n),P("sendAntiEntropyRequest",{type:"Request",id:t,causality:this._document._communication.causality})}},{key:"sendAntiEntropyResponse",value:function(){var e=Object(h.a)(d.a.mark(function e(t,n,a){var i;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=this._document._options.editingSessionID,e.next=3,this.unicast(t,{type:"Response",id:i,causalityAtReceipt:n,elements:a});case 3:P("sendAntiEntropyResponse",{type:"Response",id:i,causalityAtReceipt:n,elements:a});case 4:case"end":return e.stop()}},e,this)}));return function(t,n,a){return e.apply(this,arguments)}}()},{key:"stopAntiEnropy",value:function(){this._intervalAntiEntropy&&clearInterval(this._intervalAntiEntropy)}},{key:"close",value:function(){this.stopAntiEnropy()}}]),t}(M),q=n(30)("CRATE:Communication:TextManager:InsertManager"),L=function(e){function t(e){var n;Object(m.a)(this,t);var a=e.EventName||"Insert";return(n=Object(f.a)(this,Object(b.a)(t).call(this,Object(u.a)({EventName:a},e))))._textManager=e.TextManager,n.action=n.insert,n._lastSentId=null,n}return Object(y.a)(t,e),Object(p.a)(t,[{key:"insert",value:function(e){var t=e.packet,n=e.position,a=e.source,i=void 0===a?"user":a;if(this.isItConvertibleToJSON(t)){var o=this.insertLSEQ(t,n);this._document.delta.ops.splice(n,0,{insert:t.content,attributes:t.attributes}),q("local Insert",{packet:t,position:n,source:i}),"user"===i&&(this.broadcast({id:this._document.uid,pair:o}),this.setLastChangesTime())}}},{key:"insertLSEQ",value:function(e,t){var n=this._sequence._get(t),a=this._sequence._get(t+1);this._sequence._c+=1;var i=this._sequence.alloc(n,a),o={elem:Object(u.a)({id:i},e),id:i};return this._sequence.applyInsert(o),o}},{key:"getIDBeforeInsert",value:function(e){var t=e._get(index),n=e._get(index+1);return this._c+=1,e.alloc(t,n)}},{key:"receive",value:function(e){var t=e.id,n=e.pair,a=e.antientropy,i=void 0!==a&&a,o=this._sequence.applyInsert(n,!1);if(q("remoteInsert","pair",n," sequence Index ",o),this._document.delta.ops.splice(o-1,0,{insert:n.elem.content,attributes:n.elem.attributes}),o>=0&&(this.setLastChangesTime(),!i)){var r={range:{index:o,length:0},id:t,stream:!1};this.Event("Caret",r)}}},{key:"isItConvertibleToJSON",value:function(e){try{JSON.parse(JSON.stringify(e));return!0}catch(t){return console.error("The object cannot be convert to json ",t,insertMsg),!1}}}]),t}(M),B=n(30)("CRATE:Communication:TextManager:RemoveManager"),W=function(e){function t(e){var n;Object(m.a)(this,t);var a=e.EventName||"Remove";return(n=Object(f.a)(this,Object(b.a)(t).call(this,Object(u.a)({EventName:a},e))))._lastSentId=null,n._textManager=e.TextManager,n.action=n.remove,n._pairs=[],n}return Object(y.a)(t,e),Object(p.a)(t,[{key:"remove",value:function(e){var t=this._sequence._get(e+1),n=this.getCausalID(t),a=this.removeFromSequence(e);this._document.delta.ops.splice(e,1),B("Remove",{index:e,reference:a}),a&&(this._sequence._c+=1,this.broadcast({id:this._document.uid,isReady:n,reference:a})),this.setLastChangesTime()}},{key:"removeFromSequence",value:function(e){if(2===this._sequence.root.subCounter)console.warn("remove from sequence is empty");else{if(!(e>=this._sequence.root.subCounter-2))return this._sequence.remove(e);console.warn("Lseq, index is out Of Bounds")}return null}},{key:"receive",value:function(e){var t=e.id,n=e.reference;e.isReady;B("receive remove",{id:t,reference:n});var a=this._sequence.applyRemove(n);if(this._document.delta.ops.splice(a-1,1),a>=0){var i={range:{index:a-1,length:0},id:t};this.Event("Caret",i)}this.setLastChangesTime()}}]),t}(M),Q=n(30)("CRATE:Communication:TextManager:TitleManager"),U=function(e){function t(e){var n;Object(m.a)(this,t);var a=e.EventName||"Title";return(n=Object(f.a)(this,Object(b.a)(t).call(this,Object(u.a)({EventName:a},e))))._textManager=e.TextManager,n._communicationChannel=n._document._communication._behaviors_comm,n.action=n.sendChangeTitle,n}return Object(y.a)(t,e),Object(p.a)(t,[{key:"sendChangeTitle",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;Q("Title sent ",e),this._document.name=e;var n={id:this._document.uid,title:e};t?(Q("send title in unicast"),this.unicast(t,n)):this.broadcast(n)}},{key:"receive",value:function(e){this.emit("changeTitle",e.title),this._document.name=e.title}}]),t}(M),z=(n(30)("CRATE:Communication:TextManager:TextManager"),function(e){function t(e){var n;Object(m.a)(this,t);var a=e.EventName||"TextManager";return(n=Object(f.a)(this,Object(b.a)(t).call(this,Object(u.a)({EventName:a},e))))._insertManager=new L(Object(u.a)({TextManager:Object(k.a)(Object(k.a)(n))},e)),n._removeManager=new W(Object(u.a)({TextManager:Object(k.a)(Object(k.a)(n))},e)),n._titleManager=new U(Object(u.a)({TextManager:Object(k.a)(Object(k.a)(n))},e)),n._antiEntropyManager=new R(Object(u.a)({TextManager:Object(k.a)(Object(k.a)(n))},e)),n._removeBuffer=new Map,n.on("sendChangeTitle",function(){n._titleManager.sendChangeTitle()}),n.on("setLastChangesTime",function(){n._titleManager.sendChangeTitle()}),n}return Object(y.a)(t,e),Object(p.a)(t,[{key:"addIdToRemoveBuffer",value:function(e){this._removeBuffer.set(this.hashCode(JSON.stringify(e)),e)}},{key:"IsItInRemoveBuffer",value:function(e){return this._removeBuffer.has(JSON.stringify(e))}},{key:"removeFromRemoveBuffer",value:function(e){this._removeBuffer.delete(JSON.stringify(e))}},{key:"close",value:function(){this._insertManager.close(),this._removeManager.close(),this._titleManager.close(),this._antiEntropyManager.close()}}]),t}(M)),G=n(91),H=n(30)("CRATE:Communication"),$=function(e){function t(e){var n;return Object(m.a)(this,t),(n=Object(f.a)(this,Object(b.a)(t).call(this)))._options=e,n._document=n._options.document,n}return Object(y.a)(t,e),Object(p.a)(t,[{key:"initModules",value:function(){var e=Object(h.a)(d.a.mark(function e(){var t=arguments;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.length>0&&void 0!==t[0]?t[0]:{},this.causality=this._data_comm.broadcast._causality,this.markerManager=new T(this._options),this.textManager=new z(this._options),e.next=6,this.waitAntientropy();case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"initConnection",value:function(){var e=Object(h.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this._document.setMessageState("Connecting: getting ICEs ..."),e.next=3,this.setWebRTCOptions(this._options);case 3:return this._document.setMessageState("Connecting: establishing connection ..."),this._options.foglet?this._foglet=this._options.foglet:(this._foglet=this.getNewFoglet(this._options),this._options._foglet=this._foglet,this._foglet.share()),e.prev=5,e.next=8,this.fogletConnection();case 8:this._document.setMessageState("Connecting: connection established..."),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(5),this._document.setMessageState("Connecting: Could not establish connection!");case 14:this.setCommunicationChannels(),this._foglet.emit("connected"),H("application connected!");case 17:case"end":return e.stop()}},e,this,[[5,11]])}));return function(){return e.apply(this,arguments)}}()},{key:"fogletConnection",value:function(){var e=Object(h.a)(d.a.mark(function e(){var t,n,a=this,i=arguments;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:3,n=function(){var e=Object(h.a)(d.a.mark(function e(t){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a._foglet.connection(a._options.foglet);case 3:e.next=14;break;case 5:if(e.prev=5,e.t0=e.catch(0),!(t>0)){e.next=13;break}return console.error(e.t0),e.next=11,n(t-1);case 11:e.next=14;break;case 13:throw new Error("Could not establish connection!",e.t0);case 14:case"end":return e.stop()}},e,this,[[0,5]])}));return function(t){return e.apply(this,arguments)}}(),e.next=4,n(t);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"waitAntientropy",value:function(){var e=Object(h.a)(d.a.mark(function e(){var t=this;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e,n){0===t._foglet.getNeighbours(1/0).length?e():(t._document.setMessageState("Loading Content..."),t.on("startReceivingStream",function(){}),t.on("endReceivingStream",function(){e()}))}));case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"setWebRTCOptions",value:function(){var e=Object(h.a)(d.a.mark(function e(t){var n,a,i;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.foglet){e.next=9;break}return n=[{url:t.stun,urls:t.stun}],e.next=4,this.getICEs(t);case 4:a=e.sent,i=Object.assign(n,a),t.webRTCOptions={trickle:!0,config:{iceServers:i}},t.wrtc&&(t.webRTCOptions.wrtc=t.wrtc),t.fogletOptions.rps.options.webrtc=t.webRTCOptions;case 9:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getICEs",value:function(){var e=Object(h.a)(d.a.mark(function e(t){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e,n){var a=t.ICEsURL||"https://carteserver.herokuapp.com/ice";a?fetch(a).then(function(e){return e.json()}).then(function(t){var n=t.ice.map(function(e){return e.urls=e.url,e});e(n)}):n("no ICEsURL in url")}));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getNewFoglet",value:function(e){return new G.Foglet(e.fogletOptions)}},{key:"setCommunicationChannels",value:function(){this._data_comm=new G.communication(this._foglet.overlay().network,"_data_comm"),this.routeMsgToEvents(this._data_comm),this._behaviors_comm=new G.communication(this._foglet.overlay().network,"_behaviors_comm"),this.routeMsgToEvents(this._behaviors_comm)}},{key:"routeMsgToEvents",value:function(e){var t=this;e.onBroadcast(function(e,n){t._document.emit(n.event,n)}),e.onUnicast(function(e,n){t._document.emit(n.event,n)}),e.onStreamBroadcast(function(e,n){t.receiveStream(e,n)}),e.onStreamUnicast(function(e,n){t.receiveStream(e,n)})}},{key:"receiveStream",value:function(e,t){var n=this;H("document","receiving a stream from ",e),this.emit("startReceivingStream");var a="",i=!0,o=1,r=0,s=0;t.on("data",function(e){if(i)o=e.numberOfChunks,H("numberOfChunks === ",o),i=!1;else{r++;var t=Math.floor(100*r/o);t>s&&(H("percentage === ",s=t),n._document.setMessageState("Loading Content "+s+"%")),a+=e}}),t.on("end",function(){var t=JSON.parse(a);a="",H("document","Message received",t.pairs,"from",e),n.receive(t.event,t,e),n.emit("endReceivingStream")})}},{key:"receive",value:function(e,t,n){H("communication receive ",e,t),this._document.emit(e,Object(u.a)({},t,{originID:n}))}},{key:"close",value:function(){var e=this;this.markerManager&&this.markerManager.close(),this.textManager&&this.textManager.close(),this._foglet.unshare(),this._foglet._networkManager._rps.network._rps.disconnect(),setTimeout(function(){e._foglet=null},2e3)}}]),t}(C.EventEmitter),V=n(30)("CRATE:Document"),J=function(e){function t(e,n,a){var i;return Object(m.a)(this,t),(i=Object(f.a)(this,Object(b.a)(t).call(this)))._options=e,i.documentIndex=n,i.crate=a,i.documentId=i._options.signalingOptions.session,i._lastChanges=(new Date).getTime(),i.documentActiveWatcher,i.state="active",i.name=e.name,i.user=e.user,i.uid=i.user.id,i.lastSentMsgId=null,i}return Object(y.a)(t,e),Object(p.a)(t,[{key:"initView",value:function(){var e=Object(h.a)(d.a.mark(function e(){var t,a;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._options.display){e.next=6;break}return e.next=3,Promise.resolve().then(n.bind(null,643));case 3:t=e.sent,a=t.View,this._view=new a(this._options,this,this._options.containerID);case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"init",value:function(){var e=Object(h.a)(d.a.mark(function e(){var t;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this._options,this._communication=new $(Object(u.a)({document:this},this._options)),e.next=4,this._communication.initConnection();case 4:return this.sequence=new E.a(this._communication._data_comm.broadcast._causality.local.e),this.delta={ops:[]},e.next=8,this._communication.initModules();case 8:if(this._foglet=this._communication._foglet,this.broadcast=this._communication._data_comm.broadcast,this.broadcastCaret=this._communication._behaviors_comm.broadcast,this.rps=this._communication._data_comm.network.rps,this.causality=this._communication.causality,this.signalingOptions=t.signalingOptions,!t.importFromJSON){e.next=17;break}return e.next=17,this.loadFromJSON(t.importFromJSON);case 17:t.display&&this._view.init(),this.emit("connected");case 19:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"setMessageState",value:function(e){this._options.display&&this._view.setMessageState(e)}},{key:"setLastChangesTime",value:function(){this._lastChanges=(new Date).getTime(),this.refreshDocument(this.sequence),this.emit("changed"),this.state,this.state="active",this.resetSleepTimer()}},{key:"resetSleepTimer",value:function(){var e=this;clearTimeout(this.documentActivityWatcher),this.documentActivityWatcher=setTimeout(function(){e.state="sleep",e.emit("sleep")},this._options.documentActivityTimeout)}},{key:"loadFromJSON",value:function(){var e=Object(h.a)(d.a.mark(function e(t){var n,a=this;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.broadcast._causality=this.broadcast._causality.constructor.fromJSON(t.causality),n=this.broadcast._causality.local,this._communication._behaviors_comm.broadcast._causality.local.e=n.e,this.sequence.fromJSON(t.sequence),this.sequence._s=n.e,this.sequence._c=n.v,this.getDeltaFromSequence().then(function(e){a.delta=e}).catch(function(e){console.error(e)});case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"saveDocument",value:function(){try{var e={date:(new Date).getTime(),title:this.name,delta:this._view._editor.viewEditor.editor.delta,sequence:this.sequence,causality:this.causality,name:this.name,webRTCOptions:this.webRTCOptions,markers:{},signalingOptions:this.signalingOptions};return store.set("CRATE2-"+this.signalingOptions.session,e),V("Document saved => ",e),!0}catch(t){return console.error(t),!1}}},{key:"refreshDocument",value:function(e){var t=this;arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._options.display&&(clearTimeout(this.refreshDocumentTimeout),this.refreshDocumentTimeout=setTimeout(function(){var e=t._view._editor.viewEditor.getSelection();t._view._editor.viewEditor.setContents(t.getDelta(),"silent"),t._view._editor.viewEditor.setSelection(e,"silent"),t._view._editor.updateCommentsLinks(),t.getDeltaFromSequence().then(function(e){t.delta=e;var n=t._view._editor.viewEditor.getSelection();t._view._editor.viewEditor.setContents(t.getDelta(),"silent"),t._view._editor.viewEditor.setSelection(n,"silent"),t._view._editor.updateCommentsLinks()})},10))}},{key:"getDelta",value:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.delta).ops.slice(0);return e.push({insert:"\n"}),{ops:e}}},{key:"getDeltaFromSequence",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return new Promise(function(n,a){var i=e.getLSEQNodes(),o=[];i.forEach(function(e){var n={insert:e.e.content,attributes:e.e.attributes};if(t){var a=e.t.s;n.attributes.color=v.a.getColor(a)}o.push(n)}),n({ops:o})})}},{key:"getLSEQNodes",value:function(){var e=[];return function t(n){n.e&&""!=n.e&&e.push(n),n.children.forEach(function(e){t(e)})}(this.sequence.root),e}},{key:"reload",value:function(){this._communication.close(),this._view&&this._view.close(),this.init()}},{key:"close",value:function(){this._communication.close(),clearTimeout(this.documentActivityWatcher),clearTimeout(this.refreshDocumentTimeout),this._view&&this._view.close(),this.crate.removeDocument(this.documentIndex)}},{key:"getId",value:function(e){return e.signalingOptions.session}},{key:"moveToNext",value:function(){this.crate.moveToNext(this.documentId)}},{key:"moveToPrevious",value:function(){this.crate.moveToPrevious(this.documentId)}},{key:"createNewDocument",value:function(e){this.crate.createNewDocument(e)}}]),t}(C.EventEmitter),Y=n(61),Z=n(94),K=n.n(Z),X=(n(444),function(e){function t(e,n){var a;return Object(m.a)(this,t),(a=Object(f.a)(this,Object(b.a)(t).call(this)))._defaultOptions=e,a._crate=n,a}return Object(y.a)(t,e),Object(p.a)(t,[{key:"buildDocument",value:function(){var e=Object(h.a)(d.a.mark(function e(t,n){var a,i,o,r,s=arguments;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s.length>2&&void 0!==s[2]?s[2]:null,a=s.length>3&&void 0!==s[3]?s[3]:{},i=Object(u.a)({},this._defaultOptions,a),o=this.prepareOptions(t,i),r=new J(o,n,this._crate),e.abrupt("return",r);case 6:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"prepareOptions",value:function(e,t){return this.setSignalingOptions(t,e),this.getLocalStorageData(t),this.setUser(t),this.setDocumentTitle(t),this.setTemporarySessionID(t),this.setFogletOptions(t),this.setDocumentActivityTimeout(t),t}},{key:"setTemporarySessionID",value:function(e){this._editingSessionID=e.user.id+"-"+Object(Y.a)(),e.editingSessionID=this._editingSessionID}},{key:"setDocumentTitle",value:function(e){var t="Untitled document";e.importFromJSON&&e.importFromJSON.title&&(t=e.importFromJSON.title),e.name=t}},{key:"setUser",value:function(e){var t={id:this.GUID(),pseudo:"Anonymous"},n={};if(K.a.get("config")){var a=K.a.get("config");n={id:a.id,pseudo:a.pseudo}}e.user=Object.assign(t,n)}},{key:"setSignalingOptions",value:function(e,t){var n={address:"https://carteserver.herokuapp.com",session:t};e.signalingOptions=Object.assign(n,e.signalingOptions),e.storageServer||(e.storageServer="")}},{key:"getLocalStorageData",value:function(e){var t=e.signalingOptions.session;K.a.get("CRATE2-"+t)&&(e.importFromJSON=K.a.get("CRATE2-"+t),e.signalingOptions=e.importFromJSON.signalingOptions)}},{key:"setFogletOptions",value:function(e){var t=e.editingSessionID,n=e.signalingOptions.session,a=e.signalingOptions.address,i=e.rps,o={id:t,verbose:!0,rps:this.getRpsOptions(n,a,i)};e=Object.assign(e,{fogletOptions:o})}},{key:"getRpsOptions",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a={type:"cyclon",options:{maxPeers:10,a:1,b:5,protocol:e,timeout:1e4,pendingTimeout:5e3,delta:12e4,signaling:{address:t,room:e,timeout:2e4}}};return Object.assign(a,n)}},{key:"setDocumentActivityTimeout",value:function(e){var t=e.documentActivityTimeout||12e4;Object.assign(e,{documentActivityTimeout:t})}},{key:"GUID",value:function(){return Object(Y.a)()}}]),t}(C.EventEmitter)),ee=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;Object(m.a)(this,e),n||(n=X),this.documentBuilder=new n(t,this),this._documents=[],this._documentsIds=new Map,this.actualSessionIndex=-1,this._documentsWaiting=new Set}return Object(p.a)(e,[{key:"getDocumentIndexs",value:function(){return Array.from(this._documents.keys())}},{key:"getDocument",value:function(e){return this._documents[e]}},{key:"getDocumentByIndex",value:function(e){return this._documents[e]}},{key:"getDocumentByDocumentId",value:function(e){var t=this.getIndexFromDocumentId(e);return this._documents[t]}},{key:"getNumberOfDocuments",value:function(){return this._documents.length}},{key:"createNewDocument",value:function(){var e=Object(h.a)(d.a.mark(function e(t){var n,a,i,o,r,s=arguments;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=s.length>1&&void 0!==s[1]?s[1]:{},a=this.getIndexFromDocumentId(t),i=this._documentsWaiting.has(t),a||0==a||i){e.next=29;break}return this._documentsWaiting.add(t),o=this.getNumberOfDocuments(),r=null,e.prev=7,e.next=10,this.documentBuilder.buildDocument(t,o,null,n);case 10:return r=e.sent,this.addDocument(r),this._documentsIds.set(t,o),e.next=15,r.initView();case 15:return this._documentsWaiting.delete(t),this.setActualDocument(t),e.next=19,r.init();case 19:e.next=26;break;case 21:e.prev=21,e.t0=e.catch(7),this._documentsWaiting.delete(t),this.exist(o)&&this.removeDocument(o),console.error("problem in the creation of the document",e.t0);case 26:return e.abrupt("return",r);case 29:if(i){e.next=34;break}return this.setActualDocument(t),e.abrupt("return",this.getDocumentByDocumentId(t));case 34:return console.warn("The document is under creation"),e.abrupt("return",null);case 36:case"end":return e.stop()}},e,this,[[7,21]])}));return function(t){return e.apply(this,arguments)}}()},{key:"addDocument",value:function(e){this._documents.push(e),this.updateView()}},{key:"removeDocument",value:function(e){var t=this;if(!this.exist(e))throw(new _).SESSION_NOT_FOUND(e);this.getDocumentIndexs().filter(function(t){return t>e}).map(function(e){return t.getDocument(e)}).map(function(e){t._documentsIds.set(t.getDocumentIdFromIndex(e.documentIndex),e.documentIndex-1),e.documentIndex-=1});var n=this.getDocumentIdFromIndex(e);this._documentsIds.delete(n),this._documents.splice(e,1),this.updateActualDocumentIndex(e),this.updateView()}},{key:"updateActualDocumentIndex",value:function(e){this.actualSessionIndex===e?this.exist(e-1)?this.setActualDocument(this.getDocumentIdFromIndex(e-1)):this.exist(e+1)?this.setActualDocument(this.getDocumentIdFromIndex(e+1)):this.actualSessionIndex=-1:this.actualSessionIndex>e&&this.actualSessionIndex--}},{key:"focusInToDocument",value:function(e){if(!this.exist(e))throw(new _).SESSION_NOT_FOUND(e);this.getDocument(e).emit("FocusIn")}},{key:"focusOutToDocument",value:function(e){if(!this.exist(e))throw _().SESSION_NOT_FOUND(e);this.getDocument(e).emit("FocusOut")}},{key:"getIndexFromDocumentId",value:function(e){return this._documentsIds.get(e)}},{key:"getDocumentIdFromIndex",value:function(e){return this.getDocument(e).documentId}},{key:"setActualDocument",value:function(e){var t=this,n=this.getIndexFromDocumentId(e);if(void 0===n)throw Error("Document "+e+" dose not exist");this.actualSessionIndex!=n&&(this.actualSessionIndex=n,this.focusInToDocument(n),this.getDocumentIndexs().filter(function(e){return e!=n}).forEach(function(e){return t.focusOutToDocument(e)}))}},{key:"getActualDocument",value:function(){return this.getDocument(this.actualSessionIndex)}},{key:"updateView",value:function(){var e=this;this.getDocumentIndexs().forEach(function(t){e.getDocument(t).emit("UpdateView",e.getNumberOfDocuments())})}},{key:"moveToNext",value:function(){return this.moveTo(this.actualSessionIndex+1)}},{key:"moveToPrevious",value:function(){return this.moveTo(this.actualSessionIndex-1)}},{key:"moveTo",value:function(e){return this.exist(e)&&this.setActualDocument(this.getDocumentIdFromIndex(e)),this}},{key:"exist",value:function(e){return void 0!==this.getDocument(e)}},{key:"exist",value:function(e){return void 0!==this.getDocument(e)}}],[{key:"getRandomId",value:function(){return Object(Y.a)()}}]),e}();ee.Marker=v.a;var te=n(105),ne={};te.get("config")||(ne.id=ee.getRandomId(),ne.pseudo=ee.Marker.getPseudoname(ne.id),ne.signalingServer="https://carteserver.herokuapp.com",ne.storageServer="https://storagecrate.herokuapp.com",ne.ICEsURL="https://carteserver.herokuapp.com/ice",ne.stunTurn="23.21.150.121",te.set("config",ne));var ae={configuration:te.get("config")},ie=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ae,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"CONFIG":return Object(u.a)({},e,{configuration:Object(u.a)({},e.configuration,t.payload)});default:return e}},oe=Object(c.b)(ie),re=(n(455),n(60)),se=n(9),ce=n.n(se),ue=n(59),le=n(248),de=n.n(le),he=n(245),me=n.n(he),pe=n(246),ve=n.n(pe),ge=n(90),fe=n.n(ge),be=n(117),ye=n.n(be),ke=n(153),we=n.n(ke),_e=n(41),Ce=n.n(_e),Oe=n(247),Ee=n.n(Oe),Se=n(249),De=n.n(Se),Ie=n(250),je=n.n(Ie),xe=n(43),Ae=n.n(xe),Te=n(50),Me=n.n(Te),Ne=n(51),Fe=n.n(Ne),Pe=n(251),Re=n.n(Pe),qe=n(253),Le=n.n(qe),Be=n(254),We=n.n(Be),Qe=n(255),Ue=n.n(Qe),ze=n(256),Ge=n.n(ze),He=n(257),$e=n.n(He),Ve=n(252),Je=n.n(Ve),Ye=n(648),Ze=n(645),Ke=n(649),Xe=n(647),et=n(457),tt=function(){function e(){Object(m.a)(this,e)}return Object(p.a)(e,null,[{key:"getHtmlFromMarkDown",value:function(e){return(new et.Converter).makeHtml(e)}}]),e}(),nt=function(e){function t(){return Object(m.a)(this,t),Object(f.a)(this,Object(b.a)(t).apply(this,arguments))}return Object(y.a)(t,e),Object(p.a)(t,[{key:"getMarkDownContent",value:function(){return'\n<img src="/logo.png" alt="SOOCRATE" style="display: block;margin-left: auto;margin-right: auto;width: 25%;margin-top: -12%;margin-bottom: 5%;">\n\n<iframe  style="display: block;margin-left: auto;margin-right: auto;width: 50%;margin-bottom: 5%;"  width="560" height="315" src="https://www.youtube.com/embed/Nd1cOFa9sHQ" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>\n\nSoocrate is developed within three research projects: "Web of Browsers" in collaboration with the company [APIZEE](https://apizee.com/) and the [ASAP](https://www.irisa.fr/asap/), the CominLabs project [DESCENT](http://www.descent.cominlabs.ueb.eu/) and the ANR project [SocioPlug](http://socioplug.univ-nantes.fr/). \nThe Soocrate editor is mainly developed by [GDD team](https://sites.google.com/site/gddlina/), [LINA](https://www.lina.univ-nantes.fr/), [Nantes University](http://www.univ-nantes.fr/)\n\n**Soocrate** aims to enable collaborative editing anywhere, at anytime, whatever the number of participants, without third party. Compared to Google Docs:\n            \n- **Soocrate**  does not limit the number of simultaneous users,\n                \n- **Soocrate**  does not rely on service providers, thus your documents belong to you and whom you trust.\n\n> **Note:** **Soocrate**  is still in its very early stage of development. Therefore, the application may be buggy. Also, even basic functionalities are not implemented yet. \nFeel free to [request functionalities, report issues, and ask questions](https://github.com/nhaouari/CRATE/issues).\n\n'}},{key:"render",value:function(){return i.a.createElement("div",{className:"textContent",dangerouslySetInnerHTML:{__html:tt.getHtmlFromMarkDown(this.getMarkDownContent())}})}}]),t}(a.Component),at=function(e){function t(){return Object(m.a)(this,t),Object(f.a)(this,Object(b.a)(t).apply(this,arguments))}return Object(y.a)(t,e),Object(p.a)(t,[{key:"getMarkDownContent",value:function(){return'\n#About\n## Web of Browser\u2019s\n\nThe project "Web of Browsers" in collaboration with the [ASAP](https://www.irisa.fr/asap/) team of IRISA and the company [APIZEE](https://apizee.com/). It\'s about building a web capable of running without web servers, just using the capabilities of web browsers.\n\nWeb browsers are the most popular runtime environment in the world. Originally they was a simple HTML readers, but they can run complex applications that interact with humans and web services. The recent introduction of WebRTC has further expanded the capabilities of browsers with support of direct communications between browsers. Browsers become decentralized execution environments where interactions between humans and web services are possible without the use of third parties.\n\n\nThis is a major evolution for: \n\n- **Privacy protection**: Many services no longer depend on service providers to function;\n- **For the right to be forgotten**: the services are fed by the navigators of the participants; data and services disappear if none of the participants wish to maintain them;\nfor scalability: Millions of participants together make an impressive computational force, crowd computing and storage.\n\nIn the "*Web of Browsers*" vision, the Web works without a server. It is massively decentralized and ephemeral. Web pages are hosted by web browser networks connected to each other through WebRTC. WeBrowse enables mass collaboration between participants without costly infrastructure while maintaining confidentiality of the exchanges. WeBrowse allows users to edit web pages anytime, anywhere, regardless of the number of participants.\n\nIn the "**Web of Browsers**" view, URIs no longer refer to HTML pages or data, but to **Web sessions**. A web session is a network of browsers hosting documents (HTML pages, data, etc.). As in the classic Web, a document can reference other documents using session URIs. Navigation is possible. If a user follows the link of a web session, the user\'s web browser joins the browser network of that session and hosts the documents for that session.\nJust like in Google Docs, every web session lets you edit documents or data in real time. However, unlike Google Docs, Web sessions do not depend on a central server and do not have limits on the number of browsers that modify a particular document --- as demonstrated by the CRATE prototype [NMM16, NMM17] .\n\nThe Web browsers is quite different from the classic Web:\n- This web forgets by default, i.e., if no user wants to share a web page, then this page disappears. We think it\'s a good thing. Indeed, the persistence of a page should require additional effort when the loss of information (forgetting) should be the default behavior.\n- This Web can be more respectful of privacy: Web pages can work without the intervention of third parties.\n- This Web can be hosted on high latency or disconnected networks. Sending information is based on the spread of rumors, i.e, this Web can be deployed on adhoc or very high latency networks.\nThis Web is able to evolve in real time.\n\nThe goal of this project is to build and experiment the **Web Browsers**. We are targeting events such as Open and Massive Online Courses (MOOCs), TV shows, conferences bringing together many people [BPD13]. We believe that WeBrowse should allow users to edit web pages anytime, anywhere, regardless of the number of participants. Even if only a small group of users among millions of participants wrote, all participants must be able to read and write in real time when they wish. In 2013, Coursera gathered 41,000 students for a MOOC entitled "Fundamentals of Online Education: Planning and Application". However, the course relied on Google\'s collaborative tools that allow simultaneous editing only to a limited number of users. The result was described as a "disaster" according to the journalists [ORE13, STR13]. This example clearly demonstrates the relevance of this use case for large groups. [TRA12] reports similar problems in a large-scale collaborative publishing context.\n\n## References\n\n- [NMM17] Brice N\xe9delec, Pascal Molli, Achour Mostefaoui. A scalable sequence encoding for collaborative editing. Concurrency and Computation: Practice and Experience. DOI:10.1002/cpe.4108\n\n- [NMM16] Brice N\xe9delec, Pascal Molli, Achour Most\xe9faoui, CRATE: Writing Stories Together with our Browsers. Demo 25th World Wide Web Conference 2016. CRATE is a real-time distributed and decentralized CollaboRATive Editor running in web browsers. [https://github.com/Chat-Wane/CRATE](https://github.com/Chat-Wane/CRATE)\n\n- [BPD13] L. B. Breslow, D. E. Pritchard, J. DeBoer, G. S. Stump, A. D. Ho, and D. T. Seaton. Studying learning in the worldwide classroom: Research into edx\u2019s first mooc. Research & Practice in Assessment, 8:13\u201325, 2013.\n\n- [ORE13] W. Oremus. Online class on how to teach online classes goes laughably awry. Slate US, february 2013.\n\n- [STR13] V. Strauss. How online class about online learning failed miserably. Washington Post, february 2013.\n\n- [TRA12] B. Tomlinson, J. Ross, P. Andre, E. Baumer, D. Patterson, J. Corneli, M. Mahaux, S. Nobarany, M. Lazzari, B. Penzenstadler, A. Torrance, D. Callele, G. Olson, S. Silberman, M. Stunder, F. R. Palamedi, A. A. Salah, E. Morrill, X. Franch, F. F. Mueller, J. J. Kaye, R. W. Black, M. L. Cohn, P. C. Shih, J. Brewer, N. Goyal, P. Nakki, J. Huang, N. Baghaei, and C. Saper. Massively distributed authorship of academic papers. In CHI \u201912 Extended Abstracts on Human Factors in Computing Systems, CHI EA \u201912, pages 11\u201320, New York, NY, USA, 2012. ACM.\n\n- [FMP+16] Davide Frey, Achour Mostefaoui, Matthieu Perrin, Pierre-Louis Roman, and Fran\xe7ois Ta\xefani. Speed for the elite, consistency for the masses: differentiating eventual consistency in large-scale distributed systems, Proceedings of the 35th Symposium on Reliable Distributed Systems (SRDS 2016), Budapest, Hungary, September, 2016 (10p.)\n\n- [NTD15] Brice N\xe9delec, Julian Tanke, Davide Frey, Pascal Molli, Achour Mostefaoui. Spray: an Adaptive Random Peer Sampling Protocol. [Technical Report] LINA-University of Nantes; INRIA Rennes - Bretagne Atlantique. 2015. <hal-01203363>\n'}},{key:"render",value:function(){return i.a.createElement("div",{dangerouslySetInnerHTML:{__html:tt.getHtmlFromMarkDown(this.getMarkDownContent())},className:"textContent"})}}]),t}(a.Component),it=n(75),ot=n.n(it),rt=n(122),st=n.n(rt),ct=n(148),ut=n.n(ct),lt=n(150),dt=n.n(lt),ht=n(149),mt=n.n(ht),pt=n(118),vt=n.n(pt),gt=n(39),ft=n.n(gt),bt=n(49),yt=n.n(bt),kt=n(105),wt=function(e){return kt.set("config",e),{type:"CONFIG",payload:e}},_t=function(e){function t(e){var n;Object(m.a)(this,t);var a={id:"",pseudo:"",signalingServer:"",storageServer:"",stunTurn:""};return(n=Object(f.a)(this,Object(b.a)(t).call(this,e))).props.configuration&&(a=Object(u.a)({},a,n.props.configuration)),n.state=a,n}return Object(y.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:"textContent"},i.a.createElement("h1",null,"Configuration"),i.a.createElement("form",{className:yt.a.container,noValidate:!0,autoComplete:"off"},i.a.createElement(ut.a,{className:yt.a.card},i.a.createElement(mt.a,null,i.a.createElement(ft.a,{variant:"h5",component:"h2",gutterBottom:!0},"Identity"),i.a.createElement(st.a,{container:!0,spacing:12},i.a.createElement(st.a,{item:!0,xs:6},i.a.createElement(ot.a,{disabled:!0,id:"id",label:"Identifier",style:{margin:8},placeholder:"Random Identifier",helperText:"This is a random user Id",fullWidth:!0,value:this.state.id,onChange:function(t){e.setState({id:t.target.value})},margin:"normal",variant:"outlined",InputLabelProps:{shrink:!0}}),i.a.createElement(ot.a,{id:"pseudo",label:"Pseudo Name",style:{margin:8},placeholder:"Pseudo Name",helperText:"Enter please the your Pseudo Name *",fullWidth:!0,value:this.state.pseudo,onChange:function(t){e.setState({pseudo:t.target.value})},margin:"normal",variant:"outlined",InputLabelProps:{shrink:!0}})),i.a.createElement(st.a,{item:!0,xs:6},i.a.createElement("div",{className:yt.a.avatar,dangerouslySetInnerHTML:{__html:ee.Marker.getAvatar(this.state.id)}})))),i.a.createElement(dt.a,{className:yt.a.submit},i.a.createElement(vt.a,{variant:"outlined",onClick:function(){var t=ee.getRandomId(),n=ee.Marker.getPseudoname(t);e.setState({pseudo:n}),e.setState({id:t})}},"Generate New ID"))),i.a.createElement(ut.a,{className:yt.a.card},i.a.createElement(mt.a,null,i.a.createElement(ft.a,{variant:"h5",component:"h2",gutterBottom:!0},"Communication"),i.a.createElement(ot.a,{id:"signalingServer",label:"Signaling Server",style:{margin:8},htmlFor:"component-error",placeholder:"Signaling server",helperText:"Enter please the signaling server address for example: https://carteserver.herokuapp.com",fullWidth:!0,value:this.state.signalingServer,onChange:function(t){e.setState({signalingServer:t.target.value})},margin:"normal",variant:"outlined",InputLabelProps:{shrink:!0}}),i.a.createElement(ot.a,{id:"storageServer",label:"Storage Server",style:{margin:8},placeholder:"Storage server",helperText:"Enter please the storage server address for example: https://storagecrate.herokuapp.com",fullWidth:!0,value:this.state.storageServer,onChange:function(t){e.setState({storageServer:t.target.value})},margin:"normal",variant:"outlined",InputLabelProps:{shrink:!0}}),i.a.createElement(ot.a,{id:"stun",label:"STUN/TURN",style:{margin:8},placeholder:"STUN/TURN address",helperText:"Enter please the STUN or Turn server address for example:23.21.150.121",fullWidth:!0,value:this.state.stunTurn,onChange:function(t){e.setState({stunTurn:t.target.value})},margin:"normal",variant:"outlined",InputLabelProps:{shrink:!0}})),i.a.createElement(dt.a,null)),i.a.createElement("div",{className:yt.a.submit},i.a.createElement(vt.a,{variant:"outlined",onClick:function(){e.props.updateConfiguration(Object(u.a)({},e.state))},className:yt.a.button},"Save"))))}}]),t}(i.a.Component),Ct=Object(s.b)(function(e){return{configuration:e.configuration}},function(e){return Object(c.a)({updateConfiguration:wt},e)})(_t),Ot=n(232),Et=n.n(Ot),St=n(105),Dt=function(e){function t(e){var n;Object(m.a)(this,t),(n=Object(f.a)(this,Object(b.a)(t).call(this,e))).documentId=n.props.match.params.documentId;var a=n.getConfig();return n.crate=new ee(a),window.crate=n.crate,n}return Object(y.a)(t,e),Object(p.a)(t,[{key:"getConfig",value:function(){var e=St.get("config");return{signalingOptions:{address:e.signalingServer},storageServer:e.storageServer,stun:e.stunTurn,ICEsURL:e.ICEsURL,containerID:"content-default",display:!0,PingPeriod:1e5,AntiEntropyPeriod:1e5,documentActivityTimeout:12e4}}},{key:"componentDidMount",value:function(){this.initCrate()}},{key:"initCrate",value:function(){this.crate.createNewDocument(this.documentId)}},{key:"render",value:function(){return i.a.createElement("div",{id:"content-default",className:Et.a.document})}}]),t}(a.Component),It=function(e){function t(){return Object(m.a)(this,t),Object(f.a)(this,Object(b.a)(t).apply(this,arguments))}return Object(y.a)(t,e),Object(p.a)(t,[{key:"getMarkDownContent",value:function(){return"\n#Publications\n[1] B. N\xe9delec, J. Tanke, P. Molli, A. Mostefaoui, D. Frey. [An Adaptive Peer-Sampling Protocol for Building Networks of Browsers](https://hal.inria.fr/hal-01619906). \nIn World Wide Web ; \xe9d. Springer Verlag, 2017, vol. 25.\n\n\n[2] B. N\xe9delec, P. Molli, A. Mostefaoui. [A scalable sequence encoding for collaborative editing](https://hal.archives-ouvertes.fr/hal-01552799v1). \nIn Concurrency and Computation: Practice and Experience ; \xe9d. Wiley, 2017.\n\n[3] N\xe9delec, B., Molli, P., Mostefaoui, A., & Desmontils, E. (2013,\nSeptember). [LSEQ: an adaptive structure for sequences in distributed\ncollaborative\nediting](http://hal.univ-nantes.fr/docs/00/92/16/33/PDF/fp025-nedelec.pdf). <i>In\nProceedings of the 2013 ACM symposium on Document engineering (pp. 37-46).</i> ACM.\n\n[4] N\xe9delec, B., Molli, P., Mostefaoui, A., & Desmontils,\nE. (2013). [Concurrency effects over variable-size identifiers in distributed\ncollaborative\nediting](https://hal.archives-ouvertes.fr/hal-00921655/document). <i>In\nDocument Changes: Modeling, Detection, Storage and Visualization (Vol. 1008,\npp. 0-7).</i>\n\n[5] N\xe9delec, B., Tanke, J., Frey, D., Molli, P., Mostefaoui, A. (2015).\n[Spray, an Adaptive Random Peer Sampling Protocol](https://hal.archives-ouvertes.fr/hal-01203363/file/spray.pdf). <i>Technical Report.</i>"}},{key:"render",value:function(){return i.a.createElement("div",{dangerouslySetInnerHTML:{__html:tt.getHtmlFromMarkDown(this.getMarkDownContent())},className:"textContent"})}}]),t}(a.Component),jt=n(237),xt=n.n(jt),At=n(238),Tt=n.n(At),Mt=n(42),Nt=n.n(Mt),Ft=n(233),Pt=n.n(Ft),Rt=n(239),qt=n.n(Rt),Lt=n(123),Bt=n.n(Lt),Wt=n(234),Qt=n.n(Wt),Ut=n(57),zt=n.n(Ut),Gt=n(152),Ht=n.n(Gt),$t=n(124),Vt=n.n($t),Jt=n(235),Yt=n.n(Jt),Zt=n(236),Kt=n.n(Zt),Xt=n(47),en=n(151),tn=n(595),nn=n(105);function an(e,t,n){return t[n]<e[n]?-1:t[n]>e[n]?1:0}var on=[{id:"title",numeric:!1,disablePadding:!0,label:"Title"},{id:"date",numeric:!1,disablePadding:!1,label:"Date"},{id:"link",numeric:!1,disablePadding:!1,label:"link"}];function rn(){var e=[];return nn.each(function(t,n){if(n.includes("CRATE2")){var a=n.split("CRATE2-")[1],i=tn(t.date,"dddd, mmmm dS, yyyy, h:MM:ss TT"),o=t.title,r="/document/".concat(a);e.push({id:a,date:i,title:o,link:r})}}),e}var sn=function(e){function t(){var e,n;Object(m.a)(this,t);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(n=Object(f.a)(this,(e=Object(b.a)(t)).call.apply(e,[this].concat(i)))).createSortHandler=function(e){return function(t){n.props.onRequestSort(t,e)}},n}return Object(y.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.onSelectAllClick,a=t.order,o=t.orderBy,r=t.numSelected,s=t.rowCount;return i.a.createElement(Pt.a,null,i.a.createElement(Bt.a,null,i.a.createElement(Nt.a,{padding:"checkbox"},i.a.createElement(Ht.a,{indeterminate:r>0&&r<s,checked:r===s,onChange:n})),on.map(function(t){return i.a.createElement(Nt.a,{key:t.id,numeric:t.numeric,padding:t.disablePadding?"none":"default",sortDirection:o===t.id&&a},i.a.createElement(Vt.a,{title:"Sort",placement:t.numeric?"bottom-end":"bottom-start",enterDelay:300},i.a.createElement(Qt.a,{active:o===t.id,direction:a,onClick:e.createSortHandler(t.id)},t.label)))},this)))}}]),t}(i.a.Component),cn=function(e){var t=e.numSelected,n=e.classes,a=e.selected,o=e.updateParent;return i.a.createElement(fe.a,{className:ce()(n.root,Object(re.a)({},n.highlight,t>0))},i.a.createElement("div",{className:n.title},t>0?i.a.createElement(ft.a,{color:"inherit",variant:"subtitle1"},t," selected"):i.a.createElement(ft.a,{variant:"h6",id:"tableTitle"},"Documents")),i.a.createElement("div",{className:n.spacer}),i.a.createElement("div",{className:n.actions},t>0?i.a.createElement(Vt.a,{title:"Delete"},i.a.createElement(Ce.a,{"aria-label":"Delete"},i.a.createElement(Yt.a,{onClick:function(){a.forEach(function(e){console.log("Remove Document "+e),nn.remove("CRATE2-".concat(e)),o()})}}))):i.a.createElement(Vt.a,{title:"Filter list"},i.a.createElement(Ce.a,{"aria-label":"Filter list"},i.a.createElement(Kt.a,null)))))};cn=Object(ue.withStyles)(function(e){return{root:{paddingRight:e.spacing.unit},highlight:"light"===e.palette.type?{color:e.palette.secondary.main,backgroundColor:Object(Xt.lighten)(e.palette.secondary.light,.85)}:{color:e.palette.text.primary,backgroundColor:e.palette.secondary.dark},spacer:{flex:"1 1 100%"},actions:{color:e.palette.text.secondary},title:{flex:"0 0 auto"}}})(cn);var un=function(e){function t(e){var n;return Object(m.a)(this,t),(n=Object(f.a)(this,Object(b.a)(t).call(this,e))).handleRequestSort=function(e,t){var a=t,i="desc";n.state.orderBy===t&&"desc"===n.state.order&&(i="asc"),n.setState({order:i,orderBy:a})},n.handleSelectAllClick=function(e){e.target.checked?n.setState(function(e){return{selected:e.data.map(function(e){return e.id})}}):n.setState({selected:[]})},n.handleClick=function(e,t){var a=n.state.selected,i=a.indexOf(t),o=[];-1===i?o=o.concat(a,t):0===i?o=o.concat(a.slice(1)):i===a.length-1?o=o.concat(a.slice(0,-1)):i>0&&(o=o.concat(a.slice(0,i),a.slice(i+1))),n.setState({selected:o})},n.handleChangePage=function(e,t){n.setState({page:t})},n.handleChangeRowsPerPage=function(e){n.setState({rowsPerPage:e.target.value})},n.isSelected=function(e){return-1!==n.state.selected.indexOf(e)},n.state={order:"asc",orderBy:"calories",selected:[],data:rn(),page:0,rowsPerPage:5},n.update=function(){console.log("update parent");var e=rn();n.setState({data:e,selected:[]})},n.update=n.update.bind(Object(k.a)(Object(k.a)(n))),n}return Object(y.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this,t=this.props.classes,n=this.state,a=n.data,o=n.order,r=n.orderBy,s=n.selected,c=n.rowsPerPage,u=n.page,l=c-Math.min(c,a.length-u*c);return i.a.createElement(zt.a,{className:(t.root,en.styles)},i.a.createElement(cn,{numSelected:s.length,selected:s,updateParent:this.update}),i.a.createElement("div",{className:t.tableWrapper},i.a.createElement(xt.a,{className:t.table,"aria-labelledby":"tableTitle"},i.a.createElement(sn,{numSelected:s.length,order:o,orderBy:r,onSelectAllClick:this.handleSelectAllClick,onRequestSort:this.handleRequestSort,rowCount:a.length}),i.a.createElement(Tt.a,null,function(e,t){var n=e.map(function(e,t){return[e,t]});return n.sort(function(e,n){var a=t(e[0],n[0]);return 0!==a?a:e[1]-n[1]}),n.map(function(e){return e[0]})}(a,function(e,t){return"desc"===e?function(e,n){return an(e,n,t)}:function(e,n){return-an(e,n,t)}}(o,r)).slice(u*c,u*c+c).map(function(t){var n=e.isSelected(t.id);return i.a.createElement(Bt.a,{hover:!0,onClick:function(n){return e.handleClick(n,t.id)},role:"checkbox","aria-checked":n,tabIndex:-1,key:t.id,selected:n},i.a.createElement(Nt.a,{padding:"checkbox"},i.a.createElement(Ht.a,{checked:n})),i.a.createElement(Nt.a,{component:"th",scope:"row",padding:"none"},t.title),i.a.createElement(Nt.a,null,t.date),i.a.createElement(Nt.a,null,i.a.createElement(Ze.a,{to:t.link},"Open")," "))}),l>0&&i.a.createElement(Bt.a,{style:{height:49*l}},i.a.createElement(Nt.a,{colSpan:6}))))),i.a.createElement(qt.a,{component:"div",count:a.length,rowsPerPage:c,page:u,backIconButtonProps:{"aria-label":"Previous Page"},nextIconButtonProps:{"aria-label":"Next Page"},onChangePage:this.handleChangePage,onChangeRowsPerPage:this.handleChangeRowsPerPage}))}}]),t}(i.a.Component),ln=Object(ue.withStyles)(en.styles)(un),dn=function(e){function t(){return Object(m.a)(this,t),Object(f.a)(this,Object(b.a)(t).apply(this,arguments))}return Object(y.a)(t,e),Object(p.a)(t,[{key:"getMarkDownContent",value:function(){return'\n#Contact Us\n\n# GDD\nGDD is a research group of [LS2N](http://www.google.com/url?q=http%3A%2F%2Fls2n.fr&sa=D&sntz=1&usg=AFQjCNHy6s6CwrzokZFpYPk24D1m6MWHjg), [University of Nantes](http://www.google.com/url?q=http%3A%2F%2Fwww.univ-nantes.fr%2F&sa=D&sntz=1&usg=AFQjCNHKMWsK8VIf-sCLC2CcKz4Jwai7Kw). GDD stands for "Gestion de Donn\xe9es Distribu\xe9es" that can be translated to "Distributed Data Management". GDD is working in federated distributed systems following 3 research directions:\n\n-   **federated data structures and consistency,**\n-   **collaborative data sharing in federations,**\n-   **security and usage control in federations.**\n\nGDD has expertise in [Distributed Systems](http://www.google.com/url?q=http%3A%2F%2Fen.wikipedia.org%2Fwiki%2FDistributed_system&sa=D&sntz=1&usg=AFQjCNFsEi7VbzZWwJFeJ9VVTIjeGi-K4w), [Distributed Collaborative Systems](http://www.google.com/url?q=http%3A%2F%2Fen.wikipedia.org%2Fwiki%2FCSCW&sa=D&sntz=1&usg=AFQjCNEfL7lo_wBiI2usTnRukK_yVPTizw), [Distributed Database systems](http://www.google.com/url?q=http%3A%2F%2Fen.wikipedia.org%2Fwiki%2FDistributed_database_management_system&sa=D&sntz=1&usg=AFQjCNEHmlLVpoNG3xR7KdUIrMI34UKBzg) and [Web of Data](http://www.google.com/url?q=http%3A%2F%2Fen.wikipedia.org%2Fwiki%2FSemantic_Web&sa=D&sntz=1&usg=AFQjCNGqR96_jR2bYPiqrzEH3iYOEm5vCQ). Our topics includes:\n\n-   **Fundations of distributed system; [distributed algorithms](http://www.google.com/url?q=http%3A%2F%2Fen.wikipedia.org%2Fwiki%2FDistributed_algorithm&sa=D&sntz=1&usg=AFQjCNFC6VP-BmJSNckEukWxaCU3ZZ6pIA), [consistency](http://www.google.com/url?q=http%3A%2F%2Fen.wikipedia.org%2Fwiki%2FConsistency_model&sa=D&sntz=1&usg=AFQjCNGCe0Lh75Ls1CTYv5MGcpRF2qpvhg), [replication](http://www.google.com/url?q=http%3A%2F%2Fen.wikipedia.org%2Fwiki%2FReplication_%28computing%29&sa=D&sntz=1&usg=AFQjCNFf7-XOm9rgw7cXiF_Pus2e_HnLyA), [availability](http://www.google.com/url?q=http%3A%2F%2Fen.wikipedia.org%2Fwiki%2FCAP_theorem&sa=D&sntz=1&usg=AFQjCNG_POWHTdZqm4afB2Z9O1btlcZs3Q), [fault-tolerance](http://www.google.com/url?q=http%3A%2F%2Fen.wikipedia.org%2Fwiki%2FCAP_theorem&sa=D&sntz=1&usg=AFQjCNG_POWHTdZqm4afB2Z9O1btlcZs3Q), [scalability](http://www.google.com/url?q=http%3A%2F%2Fen.wikipedia.org%2Fwiki%2FScalability&sa=D&sntz=1&usg=AFQjCNHNoEuH67HOthpXHPxDoVA5OY9mGA),**\n-   **Distributed Data Management in [Web of Data](http://www.google.com/url?q=http%3A%2F%2Fen.wikipedia.org%2Fwiki%2FSemantic_Web&sa=D&sntz=1&usg=AFQjCNGqR96_jR2bYPiqrzEH3iYOEm5vCQ): [data integration](http://www.google.com/url?q=http%3A%2F%2Fen.wikipedia.org%2Fwiki%2FData_integration&sa=D&sntz=1&usg=AFQjCNEH0VDplcrxOmPsz1ERJ2QKLdxFVA), [social semantic web](http://www.google.com/url?q=http%3A%2F%2Fen.wikipedia.org%2Fwiki%2FSocial_Semantic_Web&sa=D&sntz=1&usg=AFQjCNGc1OMp4I1hKmdRAsGHm-ns3FYQDA), linked data,**\n-   **Privacy and confidentiality in distributed data management**\n\nThese topics are present in the following scientific domains:\n\n-   [**Distributed and Parallel Computing**](http://www.google.com/url?q=http%3A%2F%2Facademic.research.microsoft.com%2FRankList%3Fentitytype%3D3%26topDomainID%3D2%26subDomainID%3D16%26last%3D0%26start%3D1%26end%3D100&sa=D&sntz=1&usg=AFQjCNEYCEQAszGp_F78W2Sq9PU321UmTw) **(ICDCS, PODC),**\n-   **[Databases](http://www.google.com/url?q=http%3A%2F%2Facademic.research.microsoft.com%2FRankList%3Fentitytype%3D3%26topDomainID%3D2%26subDomainID%3D18%26last%3D0%26start%3D1%26end%3D100&sa=D&sntz=1&usg=AFQjCNFGu2aZo7Dn5_qGyOja7ilSfcud3g) (VLDB,SIGMOD),**\n-   **[WWW](http://www.google.com/url?q=http%3A%2F%2Facademic.research.microsoft.com%2FRankList%3Fentitytype%3D3%26topDomainID%3D2%26subDomainID%3D15%26last%3D0%26start%3D1%26end%3D100&sa=D&sntz=1&usg=AFQjCNGiLFfYRWDZSit7aYmh-pASQQoZgA) and [Semantic web](http://www.google.com/url?q=http%3A%2F%2Fen.wikipedia.org%2Fwiki%2FSemantic_Web&sa=D&sntz=1&usg=AFQjCNGqR96_jR2bYPiqrzEH3iYOEm5vCQ) (WWW,ISWC).**\n\nGDD is member of [Labex Comin Labs](http://www.google.com/url?q=http%3A%2F%2Fwww.cominlabs.ueb.eu%2F&sa=D&sntz=1&usg=AFQjCNFLSaeGUJN82jDo54bDjcxjyw4fZQ). The CominLabs federate the best teams from Bretagne and Nantes regions in the broad area of telecommunications, from electronic devices to wide area distributed applications \u201cover the top\u201d.\n\n\n# GDD Team members\n## Administrative Assistant\n\n-   [Sandrine THENOT](https://www.google.com/url?q=https%3A%2F%2Fls2n.fr%2Fsandrine%2F&sa=D&sntz=1&usg=AFQjCNGuaeDfcUxvxZ-lOilEzKZHJGIvwQ), Administrative assistant.\n\n## Professors\n\n-   [**Pascal Molli**](http://www.google.com/url?q=http%3A%2F%2Fpagesperso.lina.univ-nantes.fr%2F~molli-p&sa=D&sntz=1&usg=AFQjCNF7LKzC0vYkmfFTa5fMwjcJgxhl9g), Full Professor at University of Nantes since September 2010, Head of GDD.\n-   [**Achour Most\xe9faoui**](https://scholar.google.fr/citations?user=q50kTWoAAAAJ&hl=fr), Full Professor at University of Nantes since November 2011, vice-head of GDD.\n\n## Associated Professors\n\n-   [**Matthieu Perrin**](https://scholar.google.fr/citations?user=WlNyiPkAAAAJ&hl=fr), Associate Professor at University of Nantes, since September 2017\n-   [**Emmanuel Desmontils**](http://www.google.com/url?q=http%3A%2F%2Fwww.univ-nantes.fr%2Fdesmontils-e&sa=D&sntz=1&usg=AFQjCNGgkNtrHJvUpbZB7ycI_bMxgK7rFQ), Associate Professor at University of Nantes, since September 1998.\n-   [**Patricia Serrano-Alvarado**](http://www.google.com/url?q=http%3A%2F%2Fpagesperso.lina.univ-nantes.fr%2F~serrano-p%2FPatricia_Serrano_Alvarado%2F&sa=D&sntz=1&usg=AFQjCNFG3G4k1wKUtD8VHQPad-Hj0jdYgg), Associate Professor at University of Nantes.\n-   [**Hala Skaf-Molli**,](http://www.google.com/url?q=http%3A%2F%2Fpagesperso.lina.univ-nantes.fr%2F~skaf-h%2F&sa=D&sntz=1&usg=AFQjCNGAPA8fOx5Oz3iGMpWNLfZwdyR8bQ) Associate Professor at University of Nantes, since October 2010.\n-   [**Gilles Nachouki**](http://www.google.com/url?q=http%3A%2F%2Fwww.lina.univ-nantes.fr%2F%3F_Gilles-NACHOUKI_.html&sa=D&sntz=1&usg=AFQjCNHQEUhwsr8EhGv-tBG1U2QqQYUXMQ), Associate Professor at University of Nantes.\n\n## PostDoc\n\n-   Sarah El Hassad, Started in March 2018\n-   [Brice N\xe9delec](https://scholar.google.com/citations?user=LciNyd8AAAAJ&hl=fr&oi=ao), started in May 2017\n\n## Engineer\n\n-   [Nourredine Haouari](http://haouari.com/), Started in February 2018\n\n## External Collaborator\n\n-   [Alban Gaignard](http://www.google.com/url?q=http%3A%2F%2Fwww.univ-nantes.fr%2Fsite-de-l-universite-de-nantes%2Falban-gaignard--1166131.kjsp&sa=D&sntz=1&usg=AFQjCNH2fS0UIbn7OG-2hvzVkcmdottLkg), CNRS engineer, Institut du thorax, Inserm UMR 1087 / CNRS UMR 6291\n\n## Ph.D. Students\n\n-   [**Thomas Minier**](https://scholar.google.fr/citations?user=lKoIrIYAAAAJ&hl=fr)**,** Started in September 2017. Advisor: Pascal Molli, Co-Advisor: Hala Skaf\n-   **Arnaud Grall,** Started in October 2017, Advirsr: Pascal Molli, Co-Advisor: Hala Skaf\n-   **Gr\xe9goire Bonin,** Started in September 2017, Advisor: Achour Mostefaoui, Co-advisor: Matthieu Perrin\n-   **Benjamin Moreau,** Started in October 2017, Advisor: Pascal Molli, Co-Advisors: Patricia Serrano & Emmanuel Desmontils\n\n'}},{key:"render",value:function(){return i.a.createElement("div",{className:"textContent",dangerouslySetInnerHTML:{__html:tt.getHtmlFromMarkDown(this.getMarkDownContent())}})}}]),t}(a.Component),hn=n(242),mn=n.n(hn),pn=n(240),vn=n.n(pn),gn=n(241),fn=n.n(gn),bn=function(e){return{success:{backgroundColor:vn.a[600]},error:{backgroundColor:e.palette.error.dark},info:{backgroundColor:e.palette.primary.dark},warning:{backgroundColor:fn.a[700]},icon:{fontSize:20},iconVariant:{opacity:.9,marginRight:e.spacing.unit},message:{display:"flex",alignItems:"center"}}},yn=function(e){function t(){var e;return Object(m.a)(this,t),(e=Object(f.a)(this,Object(b.a)(t).call(this))).handleClick=function(t){return function(){e.setState(Object(u.a)({open:!0},t))}},e.handleClose=function(){e.setState({open:!1})},e.state={open:!1,message:""},e}return Object(y.a)(t,e),Object(p.a)(t,[{key:"componentDidUpdate",value:function(e,t,n){e.configuration!==this.props.configuration&&this.setState({open:!0,message:"Configuration Saved!"})}},{key:"render",value:function(){var e=this.state,t=e.open,n=e.message;return i.a.createElement("div",null,i.a.createElement(mn.a,{autoHideDuration:500,anchorOrigin:{vertical:"top",horizontal:"center"},open:t,onClose:this.handleClose,className:bn.success,ContentProps:{"aria-describedby":"message-id"},message:i.a.createElement("span",{id:"message-id"},n)}))}}]),t}(i.a.Component),kn=Object(s.b)(function(e){return Object(u.a)({},e)})(yn),wn=n(646),_n=n(243),Cn=n(244),On=n.n(Cn),En=function(e){function t(){var e;return Object(m.a)(this,t),(e=Object(f.a)(this,Object(b.a)(t).call(this))).state={open:!1,page:"Home"},e.handleDrawerOpen=function(){e.setState({open:!0})},e.handleDrawerClose=function(){e.setState({open:!1})},e}return Object(y.a)(t,e),Object(p.a)(t,[{key:"setPage",value:function(e){this.setState({page:e})}},{key:"render",value:function(){var e=this.props,t=e.classes,n=e.theme,a=this.state.open;return i.a.createElement(wn.a,null,i.a.createElement("div",{className:t.root},i.a.createElement(me.a,null),i.a.createElement(ve.a,{position:"fixed",className:ce()(t.appBar,Object(re.a)({},t.appBarShift,a))},i.a.createElement(fe.a,{disableGutters:!a},i.a.createElement(Ce.a,{color:"inherit","aria-label":"Open drawer",onClick:this.handleDrawerOpen,className:ce()(t.menuButton,a&&t.hide)},i.a.createElement(Ee.a,null)),i.a.createElement("div",{className:On.a.logo},"Soocrate",i.a.createElement("sub",{style:{"font-size":"small"}},"V",_n.a)),i.a.createElement(Ce.a,{color:"inherit",className:{display:"flex",alignItems:"right",position:"absolute"}}))),i.a.createElement(de.a,{className:t.drawer,variant:"persistent",anchor:"left",open:a,classes:{paper:t.drawerPaper}},i.a.createElement("div",{className:t.drawerHeader},i.a.createElement(Ce.a,{onClick:this.handleDrawerClose},"ltr"===n.direction?i.a.createElement(De.a,null):i.a.createElement(je.a,null))),i.a.createElement(we.a,null),i.a.createElement(ye.a,null,i.a.createElement(Ae.a,{button:!0,key:"Home",component:Ze.a,to:"/"},i.a.createElement(Me.a,null," ",i.a.createElement(Re.a,null)," "),i.a.createElement(Fe.a,{primary:"Home"})),i.a.createElement(Ae.a,{button:!0,key:"Storage",component:Ze.a,to:"/storage",onClick:this.handleDrawerClose},i.a.createElement(Me.a,null," ",i.a.createElement(Je.a,null)," "),i.a.createElement(Fe.a,{primary:"Storage"})),i.a.createElement(Ae.a,{button:!0,key:"New Document",component:Ze.a,to:"/document",onClick:this.handleDrawerClose},i.a.createElement(Me.a,null,i.a.createElement(Le.a,null)),i.a.createElement(Fe.a,{primary:"New Document"})),i.a.createElement(Ae.a,{button:!0,key:"Configuration",component:Ze.a,to:"/configuration"},i.a.createElement(Me.a,null,i.a.createElement(We.a,null)),i.a.createElement(Fe.a,{primary:"Configuration"}))),i.a.createElement(we.a,null),i.a.createElement(ye.a,null,i.a.createElement(Ae.a,{button:!0,key:"About",component:Ze.a,to:"/about"},i.a.createElement(Me.a,null,i.a.createElement(Ue.a,null)),i.a.createElement(Fe.a,{primary:"About"})),i.a.createElement(Ae.a,{button:!0,key:"Publications",component:Ze.a,to:"/publications"},i.a.createElement(Me.a,null,i.a.createElement(Ge.a,null)),i.a.createElement(Fe.a,{primary:"Publications"})),i.a.createElement(Ae.a,{button:!0,key:"Contact us",component:Ze.a,to:"/contactus"},i.a.createElement(Me.a,null,i.a.createElement($e.a,null)),i.a.createElement(Fe.a,{primary:"Contact us"})))),i.a.createElement("main",{className:ce()(t.content,Object(re.a)({},t.contentShift,a))},i.a.createElement(Ke.a,null,i.a.createElement(Xe.a,{exact:!0,path:"/",component:nt}),i.a.createElement(Xe.a,{exact:!0,path:"/about",component:at}),i.a.createElement(Xe.a,{exact:!0,path:"/document",render:function(){return i.a.createElement(Ye.a,{to:"/document/"+ee.getRandomId()})}}),i.a.createElement(Xe.a,{exact:!0,path:"/document/:documentId",component:Dt}),i.a.createElement(Xe.a,{exact:!0,path:"/contactus",component:dn}),i.a.createElement(Xe.a,{exact:!0,path:"/configuration",component:Ct}),i.a.createElement(Xe.a,{exact:!0,path:"/storage",component:ln}),i.a.createElement(Xe.a,{exact:!0,path:"/publications",component:It}))),i.a.createElement(kn,null)))}}]),t}(i.a.Component),Sn=Object(ue.withStyles)(function(e){return{root:{display:"flex"},appBar:{background:"linear-gradient(to right bottom, #d63667, #e25b72, #ed797f, #f79691, #ffb2a6)",transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})},appBarShift:{width:"calc(100% - ".concat(240,"px)"),marginLeft:240,transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen})},menuButton:{marginLeft:12,marginRight:20},hide:{display:"none"},drawer:{width:240,flexShrink:0},drawerPaper:{width:240},drawerHeader:Object(u.a)({display:"flex",alignItems:"center",padding:"0 8px"},e.mixins.toolbar,{justifyContent:"flex-end"}),content:{"margin-top":"40px",flexGrow:1,padding:3*e.spacing.unit,transition:e.transitions.create("margin",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),marginLeft:-240},contentShift:{transition:e.transitions.create("margin",{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen}),marginLeft:0}}},{withTheme:!0})(En);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(i.a.createElement(s.a,{store:oe},i.a.createElement(Sn,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},643:function(e,t,n){"use strict";n.r(t);var a=n(4),i=n(5),o=function(){function e(t,n){Object(a.a)(this,e),this.linkContainer=jQuery("<div>").appendTo(t).css("position","relative").css("top","0px").css("width","45vw-25px").css("z-index","0").css("opacity","0.9").attr("id","linkContainer").hide();var i=jQuery("<div>").appendTo(t).attr("id","modalQRCode"+n).attr("tabindex","-1").attr("role","dialog").attr("aria-labelledby","modalQRCodeLabel").attr("aria-hidden","true").addClass("modal"),o=jQuery("<div>").appendTo(i).addClass("modal-dialog"),r=jQuery("<div>").appendTo(o).addClass("modal-content text-center");this.qrcodeCanvas=jQuery("<div>"),r.append(jQuery("<br>")).append(this.qrcodeCanvas).append(jQuery("<br>")),this.alert=jQuery("<div>").appendTo(this.linkContainer),this.dismiss=jQuery("<button>").appendTo(this.alert).attr("type","button").addClass("close").html('<span  aria-hidden="true">&times;</span><span class="sr-only"> Close </span>');var s=jQuery("<div>").appendTo(this.alert).addClass("container"),c=jQuery("<div>").appendTo(s).addClass("input-group").attr("style","margin-left: -16px;");this.input=jQuery("<input>").appendTo(c).attr("type","text").attr("id","sessionUrl").attr("placeholder","Nothing to see here, move along.").addClass("form-control");var u=jQuery("<span>").appendTo(c).addClass("input-group-btn");this.qrcode=jQuery("<button>").appendTo(u).attr("aria-label","QR-code").attr("type","button").attr("data-target","#modalQRCode"+n).attr("data-toggle","modal").addClass("btn btn-default").html('<i class="fa fa-qrcode"></i>'),this.action=jQuery('<button  id="copyButton">').appendTo(u).attr("aria-label","Go!").attr("type","button").addClass("btn btn-default").html("Go!").css("z-index","15");var l=this;this.dismiss.unbind("click").click(function(){l.linkContainer.hide()})}return Object(i.a)(e,[{key:"printLink",value:function(e){this.linkContainer.show(),this.action.html('<i class="fa fa-clipboard"></i>'),this.action.attr("aria-label","Copy to clipboard"),this.input.attr("readonly","readonly"),this.input.val(e),this.qrcode.show()}},{key:"printLaunchLink",value:function(e){return this.printLink(e),this.input.attr("placeholder","A link will appear in this field, give it to your friend!"),this.action.unbind("click"),this.qrcode.hide(),this.action}},{key:"printAnswerLink",value:function(e){return this.printLink(e),this.input.attr("placeholder","A link will appear in this field. Please give it back to your friend."),this.action.unbind("click"),this.qrcode.hide(),this.action}},{key:"askLink",value:function(){this.linkContainer.show(),this.alert.removeClass("alert-warning").addClass("alert-info"),this.action.html("Go!"),this.action.attr("aria-label","Stamp the ticket"),this.input.removeAttr("readonly"),this.input.val(""),this.action.unbind("click"),this.qrcode.hide()}},{key:"askLaunchLink",value:function(){return this.askLink(),this.input.attr("placeholder","Please, copy the ticket of your friend here to stamp it!"),this.qrcode.hide(),this.action}},{key:"askAnswerLink",value:function(){return this.askLink(),this.input.attr("placeholder","Copy the stamped ticket to confirm your arrival in the network"),this.qrcode.hide(),this.action}},{key:"hide",value:function(){this.linkContainer.hide()}}]),e}(),r=n(93),s=(n(425),function(){function e(t,n,i,o){var s=this;Object(a.a)(this,e),this.document=t,this.startSharingText='<i class="fa fa-link fa-2x ficon2"></i>',this.startSharingTooltip="start sharing",this.stopSharingText='<i class="fa fa-unlink fa-2x ficon2"></i>',this.stopSharingTooltip="stop sharing",this.red="#cd2626",this.yellow="#eead0e",this.green="#228b22",this.blue="#00BFFF",this._editorContainerID=o,this.networkState=$("#".concat(this._editorContainerID," #state")),Object(r.a)("#".concat(this._editorContainerID," #state"),{content:"Network state",theme:"light rounded",delay:100,arrow:!0}),Object(r.a)("#".concat(this._editorContainerID," #saveicon"),{content:"Save document",theme:"light rounded",delay:100,arrow:!0}),Object(r.a)("#".concat(this._editorContainerID," #remotesave"),{content:"Remote save",theme:"light rounded",delay:100,arrow:!0});var c=$("#".concat(this._editorContainerID," #sharingContainer")),u=($("#".concat(this._editorContainerID," #shareicon")),window.location.href.split("/"));u.splice(-1,1),u=u.join("/")+"/"+this.document.documentId;c.jsSocials({url:u,text:$("#".concat(s._editorContainerID," #title")).text().replace(/(\r\n\t|\n|\r\t)/gm,""),showLabel:!1,showCount:!1,shares:["twitter","facebook","linkedin","whatsapp"]}),c.append('<div id="link" style="display: none;">'.concat(u,"</i>")),c.prepend("<h5>Share!</h5>"),$("#".concat(this._editorContainerID," #sharingContainer .jssocials-shares")).append('<div class="jssocials-share"><i id="copy" class="fa fa-copy jssocials-share-logo"></i></div>'),$("#".concat(this._editorContainerID," #sharingContainer #copy")).click(function(){s.copyToClipboard(u)}),Object(r.a)("#".concat(this._editorContainerID," #shareicon"),{theme:"light rounded",arrow:!0,interactive:!0,content:document.querySelector("#sharingContainer")}),this.setNetworkState("partiallyConnected"),this.document.rps.on("connect",function(){s.checkNetworkState()}),this.document.rps.on("data",function(){s.checkNetworkState()}),this.document.rps.on("stream",function(){s.checkNetworkState()}),this.document.rps.on("receive",function(){s.checkNetworkState()}),this.document.rps.on("open",function(){s.checkNetworkState()}),this.document.rps.on("close",function(e){setTimeout(function(){s.checkNetworkState()},0)})}return Object(i.a)(e,[{key:"checkNetworkState",value:function(){var e=this.document._foglet.getNeighbours(1/0).length;e>0?this.setNetworkState("connected"):0===e&&this.setNetworkState("partiallyConnected")}},{key:"copyToClipboard",value:function(e){var t=document.createElement("input");document.body.appendChild(t),t.setAttribute("value",e),t.select(),document.execCommand("copy"),document.body.removeChild(t)}},{key:"setNetworkState",value:function(e){switch(e){case"connected":this.networkState.css("color",this.green),this.networkState.attr("data-content","<span class='alert-success'>Congratulations!</span>\n                     You are connected to people, and people are \n                     connected to you. <span class='alert-info'>You can start editing \" \n                     together</span>.");break;case"partiallyConnected":this.networkState.css("color",this.yellow),this.networkState.attr("data-content","<span class='alert-warning'>Partially connected</span>: \n                     either you are connected to people, or people are connected to you. \n                     This is not great, but you <span class='alert-info'> still can edit.</span>");break;case"disconnected":this.networkState.css("color",this.red),this.networkState.attr("data-content","<span class='alert-danger'>Disconnected</span>:\n                     you are currently editing <span class='alert-info'>on\n                    your own</span>.")}}}]),e}()),c=n(11),u=n(8),l=n(10),d=n(15),h=n.n(d),m=n(28),p=(n(426),n(30)("crate:view:comments")),v=function(){function e(){Object(a.a)(this,e),this._commentCallback={},this.commentAddClick=this.commentAddClick.bind(this),this.commentsClick=this.commentsClick.bind(this)}return Object(i.a)(e,[{key:"init",value:function(e){return this._editor=e,this._authorId=this._editor._document.uid,this._editorContainerID=this._editor._editorContainerID,this._viewEditor=this._editor.viewEditor,this._markerManager=this._editor._MarkerViewManager,this.setSelectors(),this}},{key:"addAuthorInformation",value:function(){var e=this._viewEditor.options.modules.comment;return e.commentAuthorId=this._authorId,e.commentAddOn=this._markerManager.getMarker(this._authorId).animal,e.color=this._markerManager.getMarker(this._authorId).colorRGB,this}},{key:"setSelectors",value:function(){this._inputCommentModel=$("#".concat(this._editorContainerID," #inputCommentModal")),this._commentsSelector=$("#".concat(this._editorContainerID," #comments")),this._ql_editorSelector=$("#".concat(this._editorContainerID," .ql-editor")),this._editorSelector=$("#".concat(this._editorContainerID," .editor")),this._commentInputSelector=$("#".concat(this._editorContainerID," #commentInput"))}},{key:"commentAddClick",value:function(e,t){console.log("commentAddClick is clicked"),this._commentCallback=e.bind(t),this._inputCommentModel.modal("show")}},{key:"getCurrentTimestamp",value:function(){return new Promise(function(e,t){e(Math.round((new Date).getTime()/1e3))})}},{key:"commentsClick",value:function(){this._commentsSelector.is(":visible")?(this._ql_editorSelector.hasClass("ql-comments")&&this._ql_editorSelector.removeClass("ql-comments"),this._commentsSelector.hide(),this._commentsSelector.css("width","0%"),this._editorSelector.css("width","100%")):(this._commentsSelector.addClass("comment"),this._editorSelector.hasClass("ql-comments")||this._editorSelector.addClass("ql-comments"),this._commentsSelector.css("width","30%"),this._editorSelector.css("width","70%"),this._commentsSelector.show())}},{key:"addCommentToList",value:function(){var e=Object(m.a)(h.a.mark(function e(t){var n,a,i,o,r,s,c,u;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=t.comment,a=t.currentTimestamp,i=t.authorId,o=this._markerManager.addMarker(i,!1,{lifetime:-1}),r=dateFormat(new Date,"dddd, mmmm dS, yyyy, h:MM:ss TT"),c={id:s="ql-comment-"+i+"-"+a,date:r,pseudoName:o.pseudoName,colorRGB:o.colorRGB,comment:n,iconURL:"./icons/".concat(o.animal,".png")},u=this.getCommentBoxDiv(c),this._commentsSelector.append(u),this.addFocusEffects(s);case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getCommentBoxDiv",value:function(e){return $("<div class='comment-box ".concat(e.id," row' id='comment-box-").concat(e.id,"' tabindex=\"1\" title='").concat(e.date,"'>\n      <div class='comment-head row'>\n        <div id=\"").concat(e.id,'"style="background-color:').concat(e.colorRGB,';width: 40px;" ><img class="imageuser" src="').concat(e.iconURL,'" alt="').concat(e.pseudoName,"\"></div>\n    \n        <div class='comment-details'>\n          <div class='comment-author'>").concat(e.pseudoName,"</div>\n        </div>\n      </div>\n      <div class='comment-body row' >").concat(e.comment,"</div>\n  \n    </div>"))}},{key:"addFocusEffects",value:function(e){var t=this;console.log("#comment-box-"+e),$("#comment-box-"+e).focusin(function(){t.commentBoxFocus(e,"in")}),$("#comment-box-"+e).focusout(function(){t.commentBoxFocus(e,"out")})}},{key:"saveComment",value:function(){var e=Object(m.a)(h.a.mark(function e(){var t,n;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this._commentInputSelector.val(),this._commentInputSelector.val(""),e.next=4,this.getCurrentTimestamp();case 4:return n=e.sent,e.next=7,this.addCommentToList({comment:t,currentTimestamp:n,authorId:this._authorId});case 7:this._commentCallback({comment:t,currentTimestamp:n});case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"commentBoxFocus",value:function(e,t){console.log(t,".ql-comments #"+e),"out"!==t?($(".ql-comments #"+e).addClass("commentFocus"),this._commentsSelector.find("."+e).css("border-color","red")):($(".ql-comments #"+e).removeClass("commentFocus"),this._commentsSelector.find(".comment-box").css("border-color","#F0F0F0"))}},{key:"UpdateComments",value:function(){var e=this;p("cmments updated"),this.clearComments(),this.viewEditor.editor.delta.ops.forEach(function(t){if(t.insert&&t.attributes&&t.attributes.commentAuthor){var n=t.attributes.commentAuthor,a=t.attributes.comment,i=t.attributes.commentTimestamp;e.addCommentToList({comment:a,currentTimestamp:i,authorId:n})}})}},{key:"clearComments",value:function(){jQuery("#".concat(this._editorContainerID," #comments")).empty()}},{key:"viewEditor",get:function(){return this._viewEditor},set:function(e){this._viewEditor=e}}]),e}(),g=n(27),f=n(231),b=n(61),y=function(){function e(t,n,i){Object(a.a)(this,e),this._editorContainerID=t,this._comments=n,this._editor=i}return Object(i.a)(e,[{key:"registerModules",value:function(){Quill.register("modules/cursors",QuillCursors),Quill.register("modules/comment",QuillComment),Quill.register("modules/imageDrop",f.a)}},{key:"getQuill",value:function(){this.registerModules();var e=new Quill("#".concat(this._editorContainerID," #editor"),{modules:{formula:!0,toolbar:{container:this.getToolbarOptions(),handlers:{subdocument:function(e){this.quill.getSelection();var t=window.location.href.split("?")[0]+"?"+Object(b.a)();this.quill.theme.tooltip.edit("link",t)},undo:function(e){this.quill.history.undo()},redo:function(e){this.quill.history.redo()}}},cursors:this.getCursorModuleOptions(),history:this.getHistoryModuleOptions(),comment:this.getCommentsModuleOptions(),imageDrop:!0},theme:"snow"});this.addExtraToolbarOptions(),e.theme.tooltip.save2=e.theme.tooltip.save;var t=this;return e.theme.tooltip.save=function(){e.theme.tooltip.save2(),t._editor.convertLocalLinks()},e}},{key:"getToolbarOptions",value:function(){return[[{header:[1,2,3,4,5,6,!1]}],[{font:[]}],["bold","italic","underline","strike"],[{align:[]}],[{list:"ordered"},{list:"bullet"}],[{color:[]},{background:[]}],["clean"],["formula","image","link"],["subdocument"],["comments-toggle"],["comments-add"]]}},{key:"getCursorModuleOptions",value:function(){return{autoRegisterListener:!0,hideDelay:500,hideSpeed:0}}},{key:"getHistoryModuleOptions",value:function(){return{delay:500,maxStack:1e3}}},{key:"getCommentsModuleOptions",value:function(e,t){return{enabled:!0,commentAuthorId:123,commentAddOn:"Author Name",color:"yellow",commentAddClick:this._comments.commentAddClick,commentsClick:this._comments.commentsClick,commentTimestamp:this._comments.getCurrentTimestamp,containerID:this._editorContainerID}}},{key:"addExtraToolbarOptions",value:function(){$(".ql-subdocument .ql-comments-toggle .ql-comments-add").attr("data-toggle","tooltip"),$(".ql-comments-toggle,.ql-comments-add").css({position:"relative",top:"-5px"}),$(".ql-subdocument").html("<strong>SUB</strong>"),$(".ql-subdocument").attr("title","Add subdocument"),$(".ql-comments-toggle").html('<i class="fa fa-comments"></i>'),$(".ql-comments-toggle").attr("title","Show/hide comments"),$(".ql-comments-add").html('<i class="fa fa-comment"></i>'),$(".ql-comments-add").attr("title","Add comment")}}]),e}(),k=n(12),w=n(72),_=n(30)("CRATE:View:MarkerViewManager"),C=function(e){function t(e,n){var i;return Object(a.a)(this,t),(i=Object(c.a)(this,Object(u.a)(t).call(this)))._markerManager=e,i._editor=n,i._markers={},i.addMarker(i._markerManager._document.uid,!0),i._markerManager.on("Ping_received",function(e){i.receivePing(e)}),i._markerManager.on("Caret_received",function(e){i.receiveCaret(e)}),i._defaultOptions={lifeTime:5e3},i}return Object(l.a)(t,e),Object(i.a)(t,[{key:"addMarker",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=Object.assign(Object(k.a)({},this._defaultOptions,{isItMe:t}),n);return this._markers.hasOwnProperty(e)||(this._markers[e]=new w.a(e,a,this._editor),t&&(store.get("myId")?this._markers[e].setPseudo(store.get("myId").pseudo):store.set("myId",{id:e,pseudo:this._markers[e].pseudoName}))),this._markers[e]}},{key:"getMarker",value:function(e){return this._markers[e]}},{key:"receivePing",value:function(e){var t=e.id,n=e.pseudo;_("Ping Received",t,n),this.getMarker(t)?this.getMarker(t).update(null,!1).setPseudo(n):this.addMarker(t,!1).setPseudo(n)}},{key:"receiveCaret",value:function(e){var t=e.range,n=e.id;n&&(this.getMarker(n)?this.getMarker(n).update(t,!0):this.addMarker(n,!1,{range:t}))}},{key:"removeMarker",value:function(){}}]),t}(g.EventEmitter),O=n(30)("crate:view:editor"),E=function(e){function t(e,n,i){var o;return Object(a.a)(this,t),(o=Object(c.a)(this,Object(u.a)(t).call(this)))._document=e,o._editorContainerID=i,o._comments={},o._sessionID=n,o._silent=!1,o}return Object(l.a)(t,e),Object(i.a)(t,[{key:"silent",value:function(e){}},{key:"startSilence",value:function(){this._silent=!0}},{key:"stopSilence",value:function(){var e=this;setTimeout(function(){e._silent=!1},0)}},{key:"loadDocument",value:function(){this._comments=new v,this._quillManager=new y(this._editorContainerID,this._comments,this),this.viewEditor=this._quillManager.getQuill()}},{key:"initDocument",value:function(){this.loadDocument(),this.initCommunicationModules(),this.loadLocalContent(this._sessionID),this._comments.init(this).addAuthorInformation().UpdateComments(),this.startEventListeners()}},{key:"initCommunicationModules",value:function(){this.markerManager=this._document._communication.markerManager,this.textManager=this._document._communication.textManager,this._MarkerViewManager=new C(this.markerManager,this)}},{key:"loadLocalContent",value:function(){if(store.get("CRATE2-"+this._sessionID)){var e=store.get("CRATE2-"+this._sessionID);this.viewEditor.setContents(e.delta,"user"),jQuery("#".concat(this._editorContainerID," #title")).text(e.title),this.convertLocalLinks()}}},{key:"startEventListeners",value:function(){var e=this;this.viewEditor.on("selection-change",function(t,n,a){t&&e.markerManager.caretMoved(t)}),this.viewEditor.on("text-change",function(t,n,a){e.textChange(t,n,a),e.emit("thereAreChanges")}),this.textManager._insertManager.on("remoteInsert",function(t,n){e.remoteInsert(t,n),e.emit("thereAreChanges")}),this.textManager._removeManager.on("remoteRemove",function(t){e.remoteRemove(t),e.emit("thereAreChanges")}),this.textManager._titleManager.on("changeTitle",function(t){jQuery("#".concat(e._editorContainerID," #title")).text(t),e.emit("thereAreChanges")})}},{key:"textChange",value:function(e,t,n){this._silent||this.applyChanges(this.getDeltaWithoutRetainWithAttributes(e),0)}},{key:"applyChanges",value:function(e,t){var n=this,a=t;this.getOperations(e).map(function(e){a=n.sendIt(e,a,!1)})}},{key:"getDeltaWithoutRetainWithAttributes",value:function(e){var t=this,n=e.ops,a=0;return{ops:n.reduce(function(e,n,i){if(n.retain&&!n.attributes)e.push(n),a+=n.retain;else if(n.retain){0===i&&e.push({retain:a}),e.push({delete:n.retain});var o=t.getDelta(a,a+n.retain);e.push.apply(e,o.ops),a+=n.retain}else e.push(n);return e},[])}}},{key:"sendIt",value:function(e,t,n){switch(e.Name){case"insert":this.sendInsert(t,e);break;case"delete":this.sendDelete(t,e,n)}return this.getNextIndex(t,e)}},{key:"getNextIndex",value:function(e,t){O("getNextIndex",{index:e,operation:t});var n=e;return"insert"===t.Name&&"text"===t.Type&&(n=e+t.Value.length),"insert"===t.Name&&"text"!=t.Type&&(n=e+1),"retain"===t.Name&&""===t.Attributes&&(n=e+t.Value),O("getNextIndex",{nextIndex:n}),n}},{key:"isItBlock",value:function(e){var t=["blockquote","header","indent","list","align","direction","code-block"];return Object.getOwnPropertyNames(e).reduce(function(e,n){return t.indexOf(n)>=0?e||!0:e||!1},!1)}},{key:"isItComplete",value:function(e){return!(e.hasOwnProperty("commentAuthor")&&Object.keys(e).length<5)}},{key:"sendInsert",value:function(e,t){return"text"===t.Type?this.sendCharByChar(t.Value,e):this.insert(t.Type,t.Value,e),e+t.Length}},{key:"sendCharByChar",value:function(e,t){for(var n=t;n<t+e.length;++n)O("send [%]",e[n-t]),this.insert("char",e[n-t],n)}},{key:"sendDelete",value:function(e,t,n){O("Send delete",e,t,n),n||this._comments.UpdateComments();for(var a=e;a<e+t.Length;++a)this.textManager._removeManager.remove(e)}},{key:"insert",value:function(e,t,n){var a=this.viewEditor.getFormat(n,1),i={type:e,content:t,attributes:a};this.textManager._insertManager.insert({packet:i,position:n}),Object.keys(a).length>0&&this.updateCommentsLinks()}},{key:"remoteInsert",value:function(e,t){var n=t-1;O("Remote Insert : ",e,n),-1!==n&&("char"===e.type?(this.viewEditor.insertText(n,e.content,e.attributes,"silent"),"\n"!=e.content&&this.viewEditor.removeFormat(n,1,"silent")):this.viewEditor.insertEmbed(n,e.type,e.content[e.type],"silent"),e.attributes&&("\n"!=e.text&&(this.viewEditor.formatLine(n,e.attributes,"silent"),this.viewEditor.formatText(n,1,e.attributes,"silent")),this.updateCommentsLinks()))}},{key:"remoteRemove",value:function(e){O("Remote remove : ",e);var t=e-1;-1!==t&&(this.viewEditor.deleteText(t,1,"silent"),this.updateCommentsLinks())}},{key:"getDelta",value:function(e,t){return this.viewEditor.editor.delta.slice(e,t)}},{key:"updateCommentsLinks",value:function(){var e=this;clearTimeout(this._timeout),this._timeout=setTimeout(function(){e.convertLocalLinks(),e._comments.UpdateComments()},500)}},{key:"convertLocalLinks",value:function(){var e=this;$("#".concat(this._document._view._editorContainerID," a")).toArray().filter(function(e){return e.href.includes("#/document/")||e.href.includes("#")||"CrateSessionID"===e.className}).forEach(function(t){e.updateLink(t)})}},{key:"updateLink",value:function(e){var t=this;this.startSilence();var n=$(e),a=n.attr("id")||n.attr("href").split("?")[1];n.attr("href","#"),n.attr("id",a),n.attr("class","CrateSessionID"),n.attr("data-toggle","Open this document"),n.addClass("CrateSessionID"),n.click(function(){t._document.createNewDocument(a)}),this.stopSilence()}},{key:"getAllLinksToCrate",value:function(){var e=[],t=$("#".concat(this._document._view._editorContainerID," a")),n=!0,a=!1,i=void 0;try{for(var o,r=t[Symbol.iterator]();!(n=(o=r.next()).done);n=!0){var s=o.value,c=$(s);(s.href.includes(window.location.href.split("#")[0]+"#/document/")||s.className.includes("CrateSessionID"))&&e.push(c)}}catch(u){a=!0,i=u}finally{try{n||null==r.return||r.return()}finally{if(a)throw i}}return e}},{key:"getOperations",value:function(e){var t=this;return e.ops.map(function(e){return t.extractOperationInformation(e)})}},{key:"extractOperationInformation",value:function(e){for(var t=Object.keys(e),n="",a="",i="",o=1,r=t.length-1;r>=0;r--){var s=e[t[r]];"attributes"===t[r]?a=s:(n=t[r],i=s)}var c=this.getTypeOfContent(i);return"delete"===n?o=i:"text"===c&&(o=i.length),O("extractOperationInformation",{Name:n,Value:i,Attributes:a,Type:c,Length:o}),{Name:n,Value:i,Attributes:a,Type:c,Length:o}}},{key:"getTypeOfContent",value:function(e){return void 0!=e.formula?"formula":void 0!=e.video?"video":void 0!=e.image?"image":"text"}}]),t}(g.EventEmitter),S=function(){function e(){Object(a.a)(this,e)}return Object(i.a)(e,null,[{key:"addMoveShortcuts",value:function(e){e.addMoveShortcuts||(e.addMoveShortcuts=function(){var e=this,t={37:"prev",39:"next"};document.addEventListener&&document.addEventListener("keydown",function(e){var n=t[e.keyCode];if((e.ctrlKey||e.metaKey)&&n){var a=document.createEvent("Event");a.initEvent(n,!0,!1),e.target.dispatchEvent(a),e.preventDefault()}},!1),$(document).on("next",function(){console.log("nnnnnext"),e.moveToNext()}),$(document).on("prev",function(){console.log("pppppprev"),e.moveToPrevious()})},e.addMoveShortcuts())}},{key:"addResize",value:function(e){e.Resize||(e.resize=function(){var e=this;this.resizeTimeout,$(window).resize(function(){clearTimeout(e.resizeTimeout),e.resizeTimeout=setTimeout(function(){e.focusInToDocument(e.actualSessionIndex),clearTimeout(e.resizeTimeout),console.log("resiiize")},200)})},e.resize())}}]),e}();n.d(t,"View",function(){return I});var D=n(30)("CRATE:View"),I=function(){function e(t,n,i){var o=this;Object(a.a)(this,e),this._options=t,this._document=n,this.crate=this._document.crate,this._editorsHolderID=i,this._editorContainerID="container-".concat(this._options.signalingOptions.session),this._document.on("FocusIn",function(){o.focusIn()}),this._document.on("FocusOut",function(){o.focusOut()}),this._document.on("UpdateView",function(e){D("UpdateView"),o.updateView(e)}),this.createCRATE(),this._options.storageServer&&(this._storageServerState={},this.findremote(!0),this._timerStorageServer=setInterval(function(){return o.findremote()},5e3));this._options.signalingOptions.session;this._editor=new E(this._document,this._options.signalingOptions.session,this._editorContainerID),S.addMoveShortcuts(this.crate),S.addResize(this.crate)}return Object(i.a)(e,[{key:"init",value:function(){var e=this;this._editor.initDocument(),this._editor.on("thereAreChanges",function(){2===e._storageServerState&&e.join()}),$(window).resize(function(){$("#comments").height($("#editor").height())}),$("#".concat(this._editorContainerID," #title")).click(function(){$("#".concat(e._editorContainerID," #title")).attr("contenteditable","true"),$(document).on("scroll touchmove mousewheel",function(e){return e.preventDefault(),e.stopPropagation(),!1})}),$("#".concat(this._editorContainerID," #closeDocument")).click(function(){e.closeDocument()}),$("#".concat(this._editorContainerID," #saveicon")).click(function(){e.saveDocument()}),$("#".concat(this._editorContainerID," #title")).focusout(function(){e.changeTitle()});var t=new o($("#".concat(this._editorContainerID," #sharinglink"))),n=$("#".concat(this._editorContainerID," #shareicon"));this._statesHeader=new s(this._document,t,n,this._editorContainerID),this.documentLoaded()}},{key:"setMessageState",value:function(e){$("#".concat(this._editorContainerID," #loading h1")).text(e)}},{key:"documentLoaded",value:function(){$("#".concat(this._editorContainerID," #loading")).hide(),$("#".concat(this._editorContainerID," .editorContent")).show()}},{key:"closeDocument",value:function(){this._document.close()}},{key:"createCRATE",value:function(){var e=this,t=' \n    <div autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" class="col-md-10 editorContainer" id="'.concat(this._editorContainerID,'" style="width:').concat(this.getWidth(),' !important" >\n  \x3c!-- editorContent --\x3e\n    <div id="loading" style="\n      width: 50%;\n      margin: auto;\n      text-align: center;\n      opacity: 0.5;\n      filter: alpha(opacity=50);\n    ">\n      <img class="imageuser" src="/icons/loading.gif"> \n          \n        <h1 style="\n        \n            font-size: xx-large;\n            /* text-align: center; */\n            color: gray;\n          "></h1>\n    </div>\n      <div class="editorContent" style="display: none;">\n          \x3c!-- Head --\x3e\n          <div id="head">\n          \n          </div>\x3c!-- Head --\x3e\n  \n          <div id="firstrow" class="row">\n  \n              <div id="title">\n              ').concat(this._options.name,'\n                  </div>\n  \n                  <div id=\'menurow\'>\n                  <div id="features">\n                  <div id="shareicon">\n                  <i class="fa fa-link fa-2x ficon2"></i>\n                  </div>\n                  <div id="saveicon"><i class="fa fa-floppy-o fa-2x ficon2"></i></div>\n                  <div id="remotesave">\n                  <i class="fa fa-cloud fa-2x ficon2"></i>\n                  </div>\n                  <div id="state">\n                  <i class="fa fa-globe fa-2x ficon2 "></i>\n              </div>\n              \n                  <div id="closeDocument">\n                  <i class="fa fa-times-circle fa-2x ficon2" style="\n              " aria-hidden="true" ></i>\n                  </div>\n              </div>\n              </div>\n              <div id=\'sharingContainer\'> \n              </div>\n          </div>\n          \n          \x3c!-- Content --\x3e\n          <div id="content" class="content">\n              <div id="users" class="row">\n              </div>\n              <div id="editorSection">\n              <div id="editor" class="editor">\n              </div>\n              <div id="comments">\n              </div>\n              </div>\n          </div>\x3c!-- Content --\x3e\n  \n          \x3c!-- inputCommentModal --\x3e\n          <div id="inputCommentModal" class="modal fade" role="dialog" style="display: none;">\n              <div class="modal-dialog">\n          \n                  \x3c!-- Modal content--\x3e\n                  <div class="modal-content">\n                      <div class="modal-body">\n                      <button type="button" class="close" data-dismiss="modal">\xd7</button>\n                      <h4>Comment</h4>\n                      <p><textarea name="commentInput" id="commentInput" style="width: 100%;" rows="5"></textarea></p>\n                      </div>\n                      <div class="modal-footer">\n                      <button type="button" class="btn btn-default" id="saveComment"data-dismiss="modal">Save</button>\n                      </div>\n                  </div>\n              \n              </div>\n          </div>\x3c!-- inputCommentModal --\x3e\n      </div>\x3c!-- editorContent --\x3e\n  </div>\n    ');$("#".concat(this._editorsHolderID)).append(t),$("#".concat(this._editorContainerID," #saveComment")).click(function(){e.saveComment()}),$("#".concat(this._editorContainerID," #remotesave")).click(function(){$("#".concat(e._editorContainerID," #remotesave")).hasClass("PIN")?e.kill():e.join()})}},{key:"getWidth",value:function(){var e=100,t=0;return this._document.crate.getNumberOfDocuments()>1&&(e=50,t/=2),"calc(".concat(e,"vw - ").concat(t,"px)")}},{key:"saveComment",value:function(){this._editor._comments.saveComment()}},{key:"saveDocument",value:function(){this._document.saveDocument()?alert("Document is saved successfully"):alert("There is a problem is saving the document")}},{key:"changeTitle",value:function(){$(document).unbind("scroll touchmove mousewheel"),$("#".concat(this._editorContainerID," #title")).attr("contenteditable","false"),""==$("#".concat(this._editorContainerID," #title")).text()&&$("#".concat(this._editorContainerID," #title")).text("Untitled document"),this._document._communication.textManager._titleManager.sendChangeTitle($("#".concat(this._editorContainerID," #title")).text())}},{key:"focusOut",value:function(){$("#container-".concat(this._document.documentId)).removeClass("activeEditor"),D("FocusOuT",this._document.documentId)}},{key:"focusIn",value:function(){$("#container-".concat(this._document.documentId)).addClass("activeEditor");var e=this._document.documentIndex;e>=1&&e--;var t=this._document.crate.getDocumentIdFromIndex(e);this._document.crate.getNumberOfDocuments()>1&&$("html, body").animate({scrollLeft:$("#container-".concat(t)).offset().left},"slow"),this._editor.viewEditor&&this._editor.viewEditor.focus()}},{key:"updateView",value:function(e){D("uodateView",this._document.documentId),$("#".concat(this._editorContainerID)).css("cssText","width:".concat(this.getWidth()," !important")),e>1&&jQuery("#content-default").css("cssText","width:calc(".concat(this.getWidth()," * ").concat(e,") !important"))}},{key:"close",value:function(){for(var e in clearInterval(this._timerStorageServer),this._editor.markers)clearInterval(e.timer);$("#".concat(this._editorContainerID)).remove()}},{key:"findremote",value:function(e){var t=this,n=this._options.signalingOptions.session,a=$("#".concat(this._editorContainerID," #remotesave"));if(this._options.storageServer){var i=this._options.storageServer+"/exist/"+n;fetch(i).then(function(e){return e.json()}).then(function(n){t._storageServerState=n.results,0==n.results?t.unpin(a):1==n.results?t.pin(a,"active"):e?t.join():t.pin(a,"sleep")}).catch(function(e){D(e),clearInterval(t._timerStorageServer),t.unpin(a)})}}},{key:"pin",value:function(e,t){"active"===t?e.css("color","green"):e.css("color","gray"),e.removeClass("UNPIN"),e.addClass("PIN")}},{key:"unpin",value:function(e){e.css("color","red"),e.removeClass("PIN"),e.addClass("UNPIN")}},{key:"join",value:function(){var e=this,t=this._options.signalingOptions.session;$.ajax({type:"GET",url:this._options.storageServer+"/join/"+t,success:function(t,n){e.findremote()},error:function(){e.findremote()},async:!0})}},{key:"kill",value:function(){var e=this,t=this._options.signalingOptions.session;1==confirm("Do you want remove document from remote server!")&&$.ajax({type:"GET",url:this._options.storageServer+"/kill/"+t,success:function(n,a){e.findremote(t)},async:!1})}}]),e}()},72:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var a=n(4),i=n(5),o=n(92),r=n.n(o),s=n(121),c=n.n(s),u=(n(30)("CRATE:Communication:MarkerManager:Marker"),function(){function e(t,n,i){if(Object(a.a)(this,e),void 0===t&&console.error("origin not defined",t),void 0===i&&console.error("editor not defined",i),0===Object.keys(i).length&&i.constructor===Object&&console.error("editor is empty",i),null==n)n={lifeTime:-1,range:{},cursor:!1,isItME:!1};this.options=n,this.origin=t,this.lifeTime=n.lifeTime,this.time=(new Date).getTime(),this.colorRGB=this.constructor.getColor(this.origin,"rgb"),this.colorRGBLight=this.constructor.getColor(this.origin,"rgba"),this.animal=this.constructor.getPseudoname(this.origin,null),this.pseudoName=this.constructor.getPseudoname(this.origin),this.avatarAdd=!1,this.cursor=n.cursor,this._editor=i,i&&(this._editorContainerID=i._editorContainerID),-1!=this.lifeTime&&(n.isItMe?this.addAvatar():this.cursor&&this.addCursor(n.range))}return Object(i.a)(e,[{key:"update",value:function(e,t){this.time=(new Date).getTime();var n=$("#".concat(this._editorContainerID)),a=$("#".concat(this._editorContainerID," #").concat(this.origin));return!a.length&&n.length&&this.addAvatar(),this.avatarAdd&&(a.attr("data-toggle","tooltip"),a.attr("title",this.pseudoName)),1==this.cursor&&1==t?this._editor.viewEditor.getModule("cursors").moveCursor(this.origin,e):1==t&&(this.cursor=t,this.addCursor(e)),this}},{key:"checkIfOutdated",value:function(){var e=(new Date).getTime();this.time;return e-this.time>=this.lifeTime&&(this.cursor&&(this._editor.viewEditor.getModule("cursors").removeCursor(this.origin),this.cursor=!1),this.removeAvatar(),!0)}},{key:"addAvatar",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"#users";jQuery("#".concat(this._editorContainerID," ").concat(t)).append(this.getAvatar());var n=$("#".concat(this._editorContainerID," #").concat(this.origin));return n.attr("data-toggle","tooltip"),n.attr("title",this.pseudoName),this.avatarAdd=!0,this.options.isItMe||(this.timer=setInterval(function(){return e.checkIfOutdated()},1e3)),this}},{key:"getAvatar",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return'<div id="'+this.origin+'"style="background-color:'+this.colorRGB+';"><img class="imageuser" src="'+e+"/icons/"+this.animal+'.png" alt="'+this.pseudoName+'"></div>'}},{key:"removeAvatar",value:function(){return $("#".concat(this._editorContainerID," #").concat(this.origin)).remove(),this.avatarAdd=!1,clearInterval(this.timer),this}},{key:"setPseudo",value:function(e){this.pseudoName=e;var t=$("#".concat(this._editorContainerID," #").concat(this.origin));return t.length&&t.attr("title",this.pseudoName),this}},{key:"addCursor",value:function(e){return this.cursor=!0,this._editor.viewEditor.getModule("cursors").setCursor(this.origin,e,this.pseudoName,this.colorRGB),this}}],[{key:"capitalize",value:function(e){return e.charAt(0).toUpperCase()+e.slice(1)}},{key:"getColor",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"rgb",n=c()(e)%206,a=7*n%206,i=11*n%206,o=Math.floor(n+50)+", "+Math.floor(a+50)+", "+Math.floor(i+50);return"rgb"===t?"rgb("+o+")":"rgba"===t?"rgba("+o+")":o}},{key:"getPseudoname",value:function(e){return"Anonymous"===(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Anonymous")?"Anonymous "+this.capitalize(r.a.words[c()(e)%r.a.words.length]):r.a.words[c()(e)%r.a.words.length]}},{key:"getAvatar",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return'<div id="'+e+'"style="background-color:'+this.getColor(e,"rgb")+';"><img class="imageuser" src="'+t+"/icons/"+this.getPseudoname(e,null)+'.png" alt="'+this.getPseudoname(e)+'"></div>'}}]),e}())}},[[259,2,1]]]);
//# sourceMappingURL=main.d9529f17.chunk.js.map